===== TOC (62 fichiers) =====
1. C:\MyCode\Konnaxionv14\frontend\components\activity-components\index.tsx
2. C:\MyCode\Konnaxionv14\frontend\components\activity-components\RecentComments.tsx
3. C:\MyCode\Konnaxionv14\frontend\components\activity-components\RecentLikes.tsx
4. C:\MyCode\Konnaxionv14\frontend\components\activity-components\RecentVisits.tsx
5. C:\MyCode\Konnaxionv14\frontend\components\activity-components\style.tsx
6. C:\MyCode\Konnaxionv14\frontend\components\auth0-components\index.tsx
7. C:\MyCode\Konnaxionv14\frontend\components\Button\Button.stories.tsx
8. C:\MyCode\Konnaxionv14\frontend\components\Button\Button.tsx
9. C:\MyCode\Konnaxionv14\frontend\components\charts\ChartCard.tsx
10. C:\MyCode\Konnaxionv14\frontend\components\concatv3.py
11. C:\MyCode\Konnaxionv14\frontend\components\CustomComment.tsx
12. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\CommentCard.tsx
13. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\index.tsx
14. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\LikeCard.tsx
15. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\LineChart.tsx
16. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\SculptureTable.tsx
17. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\StatisticCard.tsx
18. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\style.tsx
19. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\UserCard.tsx
20. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\UserPieChart.tsx
21. C:\MyCode\Konnaxionv14\frontend\components\dashboard-components\VisitCard.tsx
22. C:\MyCode\Konnaxionv14\frontend\components\layout-components\Drawer.tsx
23. C:\MyCode\Konnaxionv14\frontend\components\layout-components\Header.tsx
24. C:\MyCode\Konnaxionv14\frontend\components\layout-components\LogoTitle.tsx
25. C:\MyCode\Konnaxionv14\frontend\components\layout-components\Main.tsx
26. C:\MyCode\Konnaxionv14\frontend\components\layout-components\MainLayout.tsx
27. C:\MyCode\Konnaxionv14\frontend\components\layout-components\Menu.tsx
28. C:\MyCode\Konnaxionv14\frontend\components\layout-components\Sider.tsx
29. C:\MyCode\Konnaxionv14\frontend\components\map-components\ControlPanel.tsx
30. C:\MyCode\Konnaxionv14\frontend\components\map-components\index.tsx
31. C:\MyCode\Konnaxionv14\frontend\components\map-components\Map.tsx
32. C:\MyCode\Konnaxionv14\frontend\components\map-components\MapMarker.tsx
33. C:\MyCode\Konnaxionv14\frontend\components\map-components\StaticMap.tsx
34. C:\MyCode\Konnaxionv14\frontend\components\PageContainer.tsx
35. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\CreateForm\CreateFormTextFields.tsx
36. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\CreateForm\index.tsx
37. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\CreateForm\MakerCreate.tsx
38. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\CreateForm\SculptureCreate.tsx
39. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\CreateForm\SculptureUploadImage.tsx
40. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\EditForm\EditFormTextFields.tsx
41. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\EditForm\EditImage.tsx
42. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\EditForm\index.tsx
43. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\EditForm\MakerEdit.tsx
44. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\EditForm\SculptureEdit.tsx
45. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\MakerList.tsx
46. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\SculptureDetail\index.tsx
47. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\SculptureDetail\SculptureComment.tsx
48. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\SculptureDetail\SculptureTrend.tsx
49. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\SculptureGrid.tsx
50. C:\MyCode\Konnaxionv14\frontend\components\sculpture-maker-components\style.tsx
51. C:\MyCode\Konnaxionv14\frontend\components\shared\utils.tsx
52. C:\MyCode\Konnaxionv14\frontend\components\TagsList.tsx
53. C:\MyCode\Konnaxionv14\frontend\components\ThemeSwitcher.tsx
54. C:\MyCode\Konnaxionv14\frontend\components\Tooltip\Tooltip.tsx
55. C:\MyCode\Konnaxionv14\frontend\components\user-components\index.tsx
56. C:\MyCode\Konnaxionv14\frontend\components\user-components\style.tsx
57. C:\MyCode\Konnaxionv14\frontend\components\user-components\UserComments.tsx
58. C:\MyCode\Konnaxionv14\frontend\components\user-components\UserLikes.tsx
59. C:\MyCode\Konnaxionv14\frontend\components\user-components\UserProfile.tsx
60. C:\MyCode\Konnaxionv14\frontend\components\user-components\UserVisit.tsx
61. C:\MyCode\Konnaxionv14\frontend\src\components\CommonWidget\page.tsx
62. C:\MyCode\Konnaxionv14\frontend\src\components\ThemeSwitcher.tsx
===== END TOC =====


===== BEGIN components/activity-components/index.tsx =====
'use client'

/**
 * Description: Component for Recent activity page
 * Author: Hieu Chu
 */

import { useState, useEffect } from 'react'
import { Row } from 'antd'
import { ColStyled } from './style'
import api from '../../api'
import Loading from '../Loading'
import Error from 'next/error'
import Head from 'next/head'
import RecentComments from './RecentComments'
import RecentVisits from './RecentVisits'
import RecentLikes from './RecentLikes'

const RecentActivity = () => {
  const [comments, setComments] = useState([])
  const [visits, setVisits] = useState([])
  const [likes, setLikes] = useState([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  useEffect(() => {
    const fetchData = async () => {
      try {
        const commentPromise = api.get('/comment')
        const visitPromise = api.get('/visit')
        const likePromise = api.get('/like')
        const [rawComments, rawVisits, rawLikes] = await Promise.all([
          commentPromise,
          visitPromise,
          likePromise
        ])
        setComments(rawComments.data)
        setVisits(rawVisits.data)
        setLikes(rawLikes.data)
        console.log('comments', rawComments.data)
        console.log('visits', rawVisits.data)
        console.log('likes', rawLikes.data)
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }

    fetchData()
  }, [])

  const deleteComment = commentId => {
    setComments(c => c.filter(x => x.commentId !== commentId))
  }

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  return (
    <>
      <Head>
        <title>Recent Activity - UOW Sculptures</title>
      </Head>

      <Row gutter={16}>
        <ColStyled xs={24} lg={12}>
          <RecentComments comments={comments} deleteComment={deleteComment} />
          <RecentVisits visits={visits} />
        </ColStyled>

        <ColStyled xs={24} lg={12}>
          <RecentLikes likes={likes} />
        </ColStyled>
      </Row>
    </>
  )
}

export default RecentActivity

===== END components/activity-components/index.tsx =====


===== BEGIN components/activity-components/RecentComments.tsx =====
/**
 * Description: Recent comments component
 * Author: Hieu Chu
 */

import moment from 'moment'
import { Tooltip, List, Card, Dropdown, message, Modal } from 'antd'
import { Comment } from '@ant-design/compatible'
import { ExclamationCircleOutlined, EllipsisOutlined } from '@ant-design/icons'

const { confirm } = Modal

import Link from 'next/link'
import api from '../../api'

const RecentComments = ({ comments, deleteComment }) => {
  const handleDelete = (e: { key: string }) => {
    console.log(e.key)
    confirm({
      title: 'Delete this comment permanently?',
      icon: <ExclamationCircleOutlined style={{ color: '#ff4d4f' }} />,
      style: { top: 110 },
      maskClosable: true,
      okText: 'Confirm',
      okButtonProps: {
        style: {
          background: '#ff4d4f',
          borderColor: '#ff4d4f'
        }
      },
      onOk: async () => {
        try {
          await api.delete(`/comment/${e.key}`)
          message.success('Deleted comment successfully!', 2)
          deleteComment(e.key)
        } catch (error: any) {
          message.error(error?.response?.data?.message || 'Failed to delete')
        }
      }
    })
  }

  comments.sort(
    (a, b) =>
      new Date(b.createdTime).getTime() - new Date(a.createdTime).getTime()
  )

  const formattedComments = comments.map(x => ({
    author: (
      <Link href={`/users/id/${x.user.userId}`}>
        <a
          style={{
            fontSize: 14,
            fontWeight: 500,
            color: 'rgba(0, 0, 0, 0.65)'
          }}
        >
          {x.user.userId.includes('auth0') ? x.user.nickname : x.user.name}
        </a>
      </Link>
    ),
    avatar: (
      <img
        src={x.user.picture}
        style={{
          width: 42,
          height: 42,
          borderRadius: '50%',
          objectFit: 'cover'
        }}
      />
    ),
    content: (
      <div style={{ fontSize: 14 }}>
        {x.content
          .trim()
          .split('\n')
          .map((line, idx) => (
            <div key={idx}>{line}</div>
          ))}
      </div>
    ),
    datetime: (
      <div style={{ display: 'flex' }}>
        <div>
          <Tooltip title={moment(x.createdTime).format('D MMMM YYYY, h:mm:ss a')}>
            <span style={{ fontSize: 14, color: 'rgba(0, 0, 0, 0.35)' }}>
              {moment(x.createdTime).fromNow()} in{' '}
            </span>
          </Tooltip>
          <Link href={`/sculptures/id/${x.sculpture.accessionId}`}>
            <a style={{ fontSize: 14 }}>{x.sculpture.name}</a>
          </Link>
        </div>

        <div
          style={{
            fontSize: 14,
            color: 'rgba(0, 0, 0, 0.45)',
            marginLeft: 'auto'
          }}
        >
          <Dropdown
            trigger={['click']}
            menu={{
              items: [{ key: x.commentId, label: 'Delete comment' }],
              onClick: handleDelete
            }}
          >
            <EllipsisOutlined />
          </Dropdown>
        </div>
      </div>
    )
  }))

  return (
    <Card
      title="Recent Comments"
      bodyStyle={{ padding: '20px 24px 0px' }}
      bordered={false}
    >
      <List
        itemLayout="horizontal"
        dataSource={formattedComments}
        className="comment-list"
        renderItem={item => (
          <li>
            <Comment
              author={item.author}
              avatar={item.avatar}
              content={item.content}
              datetime={item.datetime}
              className="comment"
            />
          </li>
        )}
        pagination={{ pageSize: 15, hideOnSinglePage: true }}
      />
    </Card>
  )
}

export default RecentComments

===== END components/activity-components/RecentComments.tsx =====


===== BEGIN components/activity-components/RecentLikes.tsx =====
/**
 * Description: Recent likes component
 * Author: Hieu Chu
 */

import moment from 'moment'
import { Tooltip, List, Comment, Card } from 'antd'
import Link from 'next/link'

const RecentLikes = ({ likes }) => {
  likes.sort(
    (a, b) => new Date(b.likedTime).getTime() - new Date(a.likedTime).getTime()
  )
  const formattedComments = likes.map(x => ({
    author: (
      <Link href={`/users/id/${x.user.userId}`}>
        <a
          style={{
            fontSize: 14,
            fontWeight: 500,
            color: 'rgba(0, 0, 0, 0.65)'
          }}
        >
          {x.user.userId.includes('auth0') ? x.user.nickname : x.user.name}
        </a>
      </Link>
    ),
    avatar: (
      <img
        src={x.user.picture}
        style={{
          width: 42,
          height: 42,
          borderRadius: '50%',
          objectFit: 'cover'
        }}
      />
    ),
    content: (
      <div
        style={{
          fontSize: 14
        }}
      >
        <Tooltip title={moment(x.likedTime).format('D MMMM YYYY, h:mm:ss a')}>
          <span
            style={{
              fontSize: 14,
              color: 'rgba(0, 0, 0, 0.35)'
            }}
          >
            {moment(x.likedTime).fromNow()}
          </span>
        </Tooltip>
      </div>
    ),
    datetime: (
      <div>
        <span
          style={{
            fontSize: 14,
            color: 'rgba(0, 0, 0, 0.35)'
          }}
        >
          liked{' '}
        </span>
        <Link href={`/sculptures/id/${x.sculpture.accessionId}`}>
          <a
            style={{
              fontSize: 14
            }}
          >
            {x.sculpture.name}
          </a>
        </Link>
      </div>
    )
  }))

  return (
    <Card
      title="Recent Likes"
      bodyStyle={{ padding: '20px 24px 0px' }}
      bordered={false}
    >
      <List
        itemLayout="horizontal"
        dataSource={formattedComments}
        className="comment-list"
        renderItem={item => (
          <li>
            <Comment
              author={item.author}
              avatar={item.avatar}
              content={item.content}
              datetime={item.datetime}
              className="comment"
            />
          </li>
        )}
        pagination={{ pageSize: 15, hideOnSinglePage: true }}
      />
    </Card>
  )
}

export default RecentLikes

===== END components/activity-components/RecentLikes.tsx =====


===== BEGIN components/activity-components/RecentVisits.tsx =====
/**
 * Description: Recent visits component
 * Author: Hieu Chu
 */

import moment from 'moment'
import { Tooltip, List, Card } from 'antd'
import { Comment } from '@ant-design/compatible'
import Link from 'next/link'

type VisitItem = {
  visitTime: string | Date
  user: {
    userId: string
    nickname?: string
    name?: string
    picture: string
  }
  sculpture: {
    accessionId: string
    name: string
  }
}

type RecentVisitsProps = {
  visits: VisitItem[]
}

const RecentVisits = ({ visits }: RecentVisitsProps) => {
  const sorted = [...visits].sort(
    (a, b) => new Date(b.visitTime).getTime() - new Date(a.visitTime).getTime()
  )

  const formattedComments = sorted.map(x => ({
    key: `${x.user.userId}-${x.visitTime}-${x.sculpture.accessionId}`,
    author: (
      <Link
        href={`/users/id/${x.user.userId}`}
        style={{ fontSize: 14, fontWeight: 500, color: 'rgba(0, 0, 0, 0.65)' }}
      >
        {x.user.userId.includes('auth0') ? x.user.nickname : x.user.name}
      </Link>
    ),
    avatar: (
      <img
        src={x.user.picture}
        alt=""
        style={{
          width: 42,
          height: 42,
          borderRadius: '50%',
          objectFit: 'cover'
        }}
      />
    ),
    content: (
      <div style={{ fontSize: 14 }}>
        <Tooltip title={moment(x.visitTime).format('D MMMM YYYY, h:mm:ss a')}>
          <span style={{ fontSize: 14, color: 'rgba(0, 0, 0, 0.35)' }}>
            {moment(x.visitTime).fromNow()}
          </span>
        </Tooltip>
      </div>
    ),
    datetime: (
      <div>
        <span style={{ fontSize: 14, color: 'rgba(0, 0, 0, 0.35)' }}>
          visited{' '}
        </span>
        <Link
          href={`/sculptures/id/${x.sculpture.accessionId}`}
          style={{ fontSize: 14 }}
        >
          {x.sculpture.name}
        </Link>
      </div>
    )
  }))

  return (
    <Card
      title="Recent Visits"
      bodyStyle={{ padding: '20px 24px 0px' }}
      bordered={false}
      style={{ marginTop: 12 }}
    >
      <List
        itemLayout="horizontal"
        dataSource={formattedComments}
        className="comment-list"
        renderItem={item => (
          <li key={item.key}>
            <Comment
              author={item.author}
              avatar={item.avatar}
              content={item.content}
              datetime={item.datetime}
              className="comment"
            />
          </li>
        )}
        pagination={{ pageSize: 15, hideOnSinglePage: true }}
      />
    </Card>
  )
}

export default RecentVisits

===== END components/activity-components/RecentVisits.tsx =====


===== BEGIN components/activity-components/style.tsx =====
/**
 * Description: Stylesheet for recent activity components
 * Author: Hieu Chu
 */

import styled from 'styled-components'
import { Card, Col, Icon, Form, Typography, Empty, Table } from 'antd'

const { Text } = Typography

export const CardStyled = props => (
  <Card bodyStyle={{ padding: '20px 24px 20px' }} bordered={false} {...props} />
)

export const ColStyled = styled(Col)`
  padding-bottom: 12px;
`

export const DescriptionIcon = styled(Icon)`
  font-size: 20px;
`

export const ShadowCard = styled(CardStyled)`
  box-shadow: rgba(0, 0, 0, 0.06) 0px 9px 24px;
  border-width: 1px;
  border-style: solid;
  border-color: rgb(242, 242, 242);
  border-radius: 3px;
  transition: all 150ms ease-in-out 0s;

  &:hover {
    box-shadow: rgba(0, 0, 0, 0.1) 0px 9px 24px;
    cursor: pointer;
    transition: all 150ms ease-in-out 0s;
  }
`

export const CustomFormItem = styled(Form.Item)`
  margin-bottom: 8px;

  &.ant-form-item-with-help {
    margin-bottom: 5px;
  }
`

export const FormCol = styled(Col)`
  padding-left: 0px !important;
  padding-right: 0px !important;
`

export const Subtitle = styled(Text)`
  display: block;
  margin-bottom: 12px;
`

export const EmptyImage = styled(Empty)`
  height: 230px;
  margin: 0;
  border-bottom: 0.3px solid rgba(0, 0, 0, 0.25);

  & .ant-empty-image {
    margin-top: 220px;
  }
`

export const StyledTable = styled(Table)`
  .ant-table table {
    border-left: 1px solid #e8e8e8;
    border-top: 1px solid #e8e8e8;
    border-right: 1px solid #e8e8e8;
  }
`

===== END components/activity-components/style.tsx =====


===== BEGIN components/auth0-components/index.tsx =====
'use client'

/**
 * Description: Auth0 component which manages authentication and admin authorization
 * Author: Hieu Chu
 */

import React, { useState, useEffect, useContext } from 'react'
import { createAuth0Client } from '@auth0/auth0-spa-js'

const DEFAULT_REDIRECT_CALLBACK = () =>
  window.history.replaceState({}, document.title, window.location.pathname)

export const Auth0Context = React.createContext()
export const useAuth0 = () => useContext(Auth0Context)
export const Auth0Provider = ({
  children,
  onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,
  ...initOptions
}) => {
  const [isAuthenticated, setIsAuthenticated] = useState()
  const [user, setUser] = useState()
  const [auth0Client, setAuth0] = useState()
  const [loading, setLoading] = useState(true)
  const [popupOpen, setPopupOpen] = useState(false)

  useEffect(() => {
    const initAuth0 = async () => {
      const auth0FromHook = await createAuth0Client(initOptions)
      setAuth0(auth0FromHook)

      if (window.location.search.includes('code=')) {
        const { appState } = await auth0FromHook.handleRedirectCallback()
        onRedirectCallback(appState)
      }

      const isAuthenticated = await auth0FromHook.isAuthenticated()

      setIsAuthenticated(isAuthenticated)

      if (isAuthenticated) {
        const user = await auth0FromHook.getUser()
        setUser(user)
      }

      setLoading(false)
    }
    initAuth0()
    // eslint-disable-next-line
  }, [])

  const loginWithPopup = async (params = {}) => {
    setPopupOpen(true)
    try {
      await auth0Client.loginWithPopup(params)
    } catch (error) {
      console.error(error)
    } finally {
      setPopupOpen(false)
    }
    const user = await auth0Client.getUser()
    setUser(user)
    setIsAuthenticated(true)
  }

  const handleRedirectCallback = async () => {
    setLoading(true)
    await auth0Client.handleRedirectCallback()
    const user = await auth0Client.getUser()
    setLoading(false)
    setIsAuthenticated(true)
    setUser(user)
  }

  return (
    <Auth0Context.Provider
      value={{
        isAuthenticated,
        user,
        loading,
        popupOpen,
        loginWithPopup,
        handleRedirectCallback,
        getIdTokenClaims: (...p) => auth0Client.getIdTokenClaims(...p),
        loginWithRedirect: (...p) => auth0Client.loginWithRedirect(...p),
        getTokenSilently: (...p) => auth0Client.getTokenSilently(...p),
        getTokenWithPopup: (...p) => auth0Client.getTokenWithPopup(...p),
        logout: (...p) => auth0Client.logout(...p)
      }}
    >
      {children}
    </Auth0Context.Provider>
  )
}

===== END components/auth0-components/index.tsx =====


===== BEGIN components/Button/Button.stories.tsx =====
import type { Meta, StoryObj } from "@storybook/react"
import { Button } from "./Button"

const meta: Meta<typeof Button> = {
  title: "Button",
  component: Button,
  args: {
    intent: "primary",
    underline: false,
    children: "Button",
    size: "lg",
  },
  argTypes: {
    intent: {
      options: ["primary", "secondary"],
      control: { type: "select" },
    },
    size: {
      options: ["sm", "lg"],
      control: { type: "select" },
    },
  },
}

type Story = StoryObj<typeof Button>

export const Default: Story = {
  render: (args) => <Button {...args} />,
}

export default meta

===== END components/Button/Button.stories.tsx =====


===== BEGIN components/Button/Button.tsx =====
import { cva, type VariantProps } from "class-variance-authority"

import { twMerge } from "tailwind-merge"

const button = cva(
  [
    "justify-center",
    "inline-flex",
    "items-center",
    "rounded-xl",
    "text-center",
    "border",
    "border-blue-400",
    "transition-colors",
    "delay-50",
  ],
  {
    variants: {
      intent: {
        primary: ["bg-blue-400", "text-white", "hover:enabled:bg-blue-700"],
        secondary: ["bg-transparent", "text-blue-400", "hover:enabled:bg-blue-400", "hover:enabled:text-white"],
      },
      size: {
        sm: ["min-w-20", "h-full", "min-h-10", "text-sm", "py-1.5", "px-4"],
        lg: ["min-w-32", "h-full", "min-h-12", "text-lg", "py-2.5", "px-6"],
      },
      underline: { true: ["underline"], false: [] },
    },
    defaultVariants: {
      intent: "primary",
      size: "lg",
    },
  }
)

export interface ButtonProps extends React.ButtonHTMLAttributes<HTMLAnchorElement>, VariantProps<typeof button> {
  underline?: boolean
  href: string
}

export function Button({ className, intent, size, underline, ...props }: ButtonProps) {
  return (
    <a className={twMerge(button({ intent, size, className, underline }))} {...props}>
      {props.children}
    </a>
  )
}

===== END components/Button/Button.tsx =====


===== BEGIN components/charts/ChartCard.tsx =====
// components/charts/ChartCard.tsx
'use client';
import React from 'react';
import { Line, Area } from '@ant-design/plots';

interface ChartCardProps {
  /** choose a compact chart variant */
  type: 'line' | 'area';
  /** [{ x: …, y: … }] or any fields you map with xField / yField */
  data: { x?: string | number; y: number }[];
  height?: number;
  /* forward any extra Ant Design Plot options */
  [key: string]: any;
}

export default function ChartCard({
  type,
  data,
  height = 60,
  ...rest
}: ChartCardProps) {
  const commonCfg = {
    data,
    height,
    autoFit: true,
    smooth: true,
    xField: 'x',
    yField: 'y',
    ...rest,               // allow overrides
  };

  return type === 'area'
    ? <Area {...commonCfg} />
    : <Line {...commonCfg} />;
}

===== END components/charts/ChartCard.tsx =====


===== BEGIN components/concatv3.py =====
#!/usr/bin/env python3
"""
Concatène tous les fichiers texte du dossier du script et de ses sous-dossiers.
Par défaut, écrit le résultat dans "Code_<nom_dossier>_<YYYYMMDD_HHMMSS>.txt" à la racine du script.
"""

from __future__ import annotations
import argparse
import fnmatch
import os
from pathlib import Path
from typing import Set, List, Optional
from datetime import datetime

DEFAULT_EXTS: Set[str] = {
    ".tx", ".md", ".markdown",
    ".json", ".yaml", ".yml", ".xml", ".toml", ".ini", ".cfg", ".conf", ".properties",
    ".html", ".htm", ".css", ".scss", ".less",
    ".js", ".jsx", ".ts", ".tsx", ".mjs", ".cjs",
    ".py", ".pyi", ".ipynb",
    ".java", ".kt", ".swift", ".rb", ".php", ".go", ".rs",
    ".c", ".h", ".cpp", ".cc", ".hpp", ".cs",
    ".sql",
    ".sh", ".bash", ".zsh", ".fish", ".ps1", ".bat",
    ".tex", ".bib",
    ".graphql", ".gql",
    ".gradle",
    ".pl", ".lua", ".r",
    ".env",
}

NAMES_WITHOUT_EXT: Set[str] = {
    "Dockerfile", "Makefile", "CMakeLists.txt",
    ".gitignore", ".gitattributes", ".editorconfig",
    "Procfile", "Gemfile", "requirements.txt", "Pipfile", "poetry.lock",
    "package.json", "package-lock.json", "yarn.lock", "pnpm-lock.yaml",
    "tsconfig.json", "eslint.config.js", ".eslintrc", ".prettierrc",
}

DEFAULT_EXCLUDE_DIRS: Set[str] = {
    ".git", ".hg", ".svn",
    "node_modules", ".next", ".nuxt",
    "dist", "build", "out", "coverage", ".cache",
    ".venv", "venv", "__pycache__",
    "target", "bin", "obj",
}


def parse_args() -> argparse.Namespace:
    p = argparse.ArgumentParser(description="Concatène les fichiers texte du projet dans un seul fichier.")
    p.add_argument("-o", "--out", default=None, help="Fichier de sortie (facultatif)")
    p.add_argument("--ext", help="Extensions additionnelles ou personnalisées, séparées par des virgules")
    p.add_argument("--include", action="append", default=[], help="Glob d'inclusion relatif à la racine (répétable)")
    p.add_argument("--exclude", action="append", default=[], help="Glob d'exclusion relatif à la racine (répétable)")
    p.add_argument("--max-size", type=int, default=2_000_000, help="Taille max par fichier en octets")
    p.add_argument("--no-headers", action="store_true", help="Ne pas imprimer d'entêtes par fichier")
    return p.parse_args()


def normalize_exts(exts_csv: Optional[str]) -> Set[str]:
    if not exts_csv:
        return set(DEFAULT_EXTS)
    parts = [e.strip().lower() for e in exts_csv.split(",") if e.strip()]
    normed = set()
    for e in parts:
        if not e.startswith("."):
            e = "." + e
        normed.add(e)
    return normed


def is_probably_text(sample: bytes) -> bool:
    if not sample:
        return True
    if b"\x00" in sample:
        return False
    try:
        sample.decode("utf-8")
        return True
    except UnicodeDecodeError:
        pass
    ctrl_hits = 0
    for b in sample:
        if b < 32 and b not in (9, 10, 13):
            ctrl_hits += 1
    return (ctrl_hits / max(1, len(sample))) < 0.01


def pick_encoding(path: Path) -> Optional[str]:
    try:
        with path.open("rb") as f:
            sample = f.read(32768)
    except Exception:
        return None
    if not is_probably_text(sample):
        return None
    for enc in ("utf-8", "utf-8-sig", "utf-16", "cp1252", "latin-1"):
        try:
            sample.decode(enc)
            return enc
        except UnicodeDecodeError:
            continue
    return "latin-1"


def relpath(base: Path, p: Path) -> str:
    try:
        return str(p.relative_to(base))
    except Exception:
        return str(p)


def should_include_file(base: Path, file_path: Path, allowed_exts: Set[str],
                        include_globs: List[str], exclude_globs: List[str],
                        max_size: int, out_path: Path) -> bool:
    if not file_path.is_file():
        return False
    if file_path == out_path:
        return False
    if file_path.suffix.lower() == ".txt":
        return False
    try:
        if file_path.stat().st_size > max_size:
            return False
    except Exception:
        return False
    rel = relpath(base, file_path)
    for pat in exclude_globs:
        if fnmatch.fnmatch(rel, pat):
            return False
    if include_globs:
        ok = any(fnmatch.fnmatch(rel, pat) for pat in include_globs)
        if not ok:
            return False
    if file_path.suffix.lower() in allowed_exts or file_path.name in NAMES_WITHOUT_EXT:
        return True
    enc = pick_encoding(file_path)
    return enc is not None


def main() -> None:
    args = parse_args()
    base_dir = Path(__file__).resolve().parent
    self_path = Path(__file__).resolve()

    if args.out:
        out_path = (base_dir / args.out).resolve()
    else:
        stamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        out_name = f"Code_{base_dir.name}_{stamp}.txt"
        out_path = (base_dir / out_name).resolve()

    allowed_exts = normalize_exts(args.ext)
    include_globs = list(args.include or [])
    exclude_globs = list(args.exclude or [])

    selected: List[Path] = []
    for root, dirs, files in os.walk(base_dir, followlinks=False):
        dirs[:] = [d for d in dirs if d not in DEFAULT_EXCLUDE_DIRS]
        root_path = Path(root)
        for name in files:
            fp = root_path / name
            # exclure le script exécuté lui-même
            try:
                if fp.resolve() == self_path:
                    continue
            except Exception:
                pass
            if should_include_file(base_dir, fp, allowed_exts, include_globs, exclude_globs, args.max_size, out_path):
                selected.append(fp)

    selected.sort(key=lambda p: relpath(base_dir, p).lower())
    out_path.parent.mkdir(parents=True, exist_ok=True)

    with out_path.open("w", encoding="utf-8", newline="\n") as out:
        for p in selected:
            enc = pick_encoding(p) or "utf-8"
            if not args.no_headers:
                out.write(f"\n===== BEGIN {relpath(base_dir, p)} =====\n")
            try:
                with p.open("r", encoding=enc, errors="strict") as f:
                    for line in f:
                        out.write(line)
            except UnicodeDecodeError:
                with p.open("r", encoding="latin-1", errors="replace") as f:
                    for line in f:
                        out.write(line)
            if not args.no_headers:
                out.write(f"\n===== END {relpath(base_dir, p)} =====\n")
            out.write("\n")

    print(f"{len(selected)} fichier(s) concaténé(s) -> {relpath(base_dir, out_path)}")


if __name__ == "__main__":
    main()

===== END components/concatv3.py =====


===== BEGIN components/CustomComment.tsx =====
'use client'

import { Typography } from 'antd'

export default function CustomComment({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <Typography.Text
      type="secondary"
      style={{ fontSize: 'var(--ant-font-size-sm)' }}
    >
      {children}
    </Typography.Text>
  )
}

===== END components/CustomComment.tsx =====


===== BEGIN components/dashboard-components/CommentCard.tsx =====
/**
 * Description: Comment statistics card, including total comments and trend graph
 * Author: Hieu Chu
 */

import {
  MainIcon,
  CardDivider,
  NumberInfoStyled,
  CardFooter,
  BarContainer
} from './style'

import dynamic from 'next/dynamic'

const MiniArea = dynamic(
  import('ant-design-pro/lib/Charts').then(mod => mod.MiniArea),
  { ssr: false }
)

export default ({
  TOTAL_COMMENTS,
  DAILY_COMMENTS,
  DAILY_COMMENTS_CHANGE,
  COMMENT_DATA
}) => {
  return (
    <>
      <div style={{ display: 'flex', alignItems: 'center' }}>
        <MainIcon
          type="message"
          theme="twoTone"
          twoToneColor="rgb(205, 34, 255)"
        />
        <NumberInfoStyled subTitle="Comments" total={TOTAL_COMMENTS} />
      </div>

      <BarContainer>
        <MiniArea
          line
          data={COMMENT_DATA}
          borderColor="rgb(205, 34, 255)"
          color="#feedff"
        />
      </BarContainer>

      <CardDivider />

      <CardFooter
        title="Daily comments"
        value={DAILY_COMMENTS}
        change={DAILY_COMMENTS_CHANGE}
      />
    </>
  )
}

===== END components/dashboard-components/CommentCard.tsx =====


===== BEGIN components/dashboard-components/index.tsx =====
import UserCard from './UserCard'
import VisitCard from './VisitCard'
import LikeCard from './LikeCard'
import CommentCard from './CommentCard'
import SculptureTable from './SculptureTable'
import UserPieChart from './UserPieChart'
import { ColStyled } from './style'

export {
  UserCard,
  VisitCard,
  LikeCard,
  CommentCard,
  SculptureTable,
  UserPieChart,
  ColStyled
}

===== END components/dashboard-components/index.tsx =====


===== BEGIN components/dashboard-components/LikeCard.tsx =====
/**
 * Description: Like statistics card, including total likes and trend graph
 * Author: Hieu Chu
 */

import {
  MainIcon,
  CardDivider,
  NumberInfoStyled,
  CardFooter,
  BarContainer
} from './style'

import dynamic from 'next/dynamic'

const MiniArea = dynamic(
  import('ant-design-pro/lib/Charts').then(mod => mod.MiniArea),
  { ssr: false }
)

export default ({
  TOTAL_LIKES,
  DAILY_LIKES,
  DAILY_LIKES_CHANGE,
  LIKE_DATA
}) => (
  <>
    <div style={{ display: 'flex', alignItems: 'center' }}>
      <MainIcon type="heart" theme="twoTone" twoToneColor="#eb2f96" />
      <NumberInfoStyled subTitle="Likes" total={TOTAL_LIKES} />
    </div>

    <BarContainer>
      <MiniArea line data={LIKE_DATA} borderColor="#eb2f96" color="#fff0f6" />
    </BarContainer>

    <CardDivider />

    <CardFooter
      title="Daily likes"
      value={DAILY_LIKES}
      change={DAILY_LIKES_CHANGE}
    />
  </>
)

===== END components/dashboard-components/LikeCard.tsx =====


===== BEGIN components/dashboard-components/LineChart.tsx =====
'use client'
import React from 'react';
import {
  LineChart as ReLineChart,
  Line,
  CartesianGrid,
  XAxis,
  YAxis,
  Tooltip,
  ResponsiveContainer,
} from 'recharts';

type DataPoint = {
  time: string;
  value: number;
};

type LineChartProps = {
  data: DataPoint[];
};

const LineChart: React.FC<LineChartProps> = ({ data }) => {
  return (
    <ResponsiveContainer width="100%" height={300}>
      <ReLineChart data={data}>
        <CartesianGrid stroke="#ccc" />
        <XAxis dataKey="time" />
        <YAxis />
        <Tooltip />
        <Line type="monotone" dataKey="value" stroke="#8884d8" />
      </ReLineChart>
    </ResponsiveContainer>
  );
};

export default LineChart;

===== END components/dashboard-components/LineChart.tsx =====


===== BEGIN components/dashboard-components/SculptureTable.tsx =====
"use client";
/**
 * Description: Sculpture table with support for sorting according to likes, comments and visits
 * Author: Hieu Chu
 */

import { Table } from 'antd'
import { CardStyled } from './style'
import styled from 'styled-components'
import { useRouter } from 'next/navigation';

const StyledTable = styled(Table)`
  .ant-table table {
    border-left: 1px solid #e8e8e8;
    border-top: 1px solid #e8e8e8;
    border-right: 1px solid #e8e8e8;
  }
`

export default ({ sculptures }) => {
  const columns = [
    {
      title: 'Sculpture Name',
      dataIndex: 'name'
    },
    {
      title: 'Author',
      key: 'author',
      render: (_, { primaryMaker: { firstName, lastName } }) => (
        <span>{`${firstName} ${lastName}`}</span>
      )
    },
    {
      title: 'Likes',
      dataIndex: 'totalLikes',
      sorter: (a, b) => a.totalLikes - b.totalLikes,
      sortDirections: ['descend', 'ascend']
    },
    {
      title: 'Comments',
      dataIndex: 'totalComments',
      sorter: (a, b) => a.totalComments - b.totalComments,
      sortDirections: ['descend', 'ascend']
    },
    {
      title: 'Visits',
      dataIndex: 'totalVisits',
      sorter: (a, b) => a.totalVisits - b.totalVisits,
      sortDirections: ['descend', 'ascend']
    }
  ]

  return (
    <CardStyled title="Sculpture Rankings">
      <StyledTable
        dataSource={sculptures}
        columns={columns}
        pagination={{ pageSize: 10 }}
        className="sculpture-table"
        onRow={(record, _) => {
          return {
            onClick: () => {
              const router = useRouter();
              router.push(`/sculptures/id/${record.key}`)
            }
          };
        }}
      />
    </CardStyled>
  );
}

===== END components/dashboard-components/SculptureTable.tsx =====


===== BEGIN components/dashboard-components/StatisticCard.tsx =====
import React from 'react';
import { Card, Statistic } from 'antd';

type StatisticCardProps = {
  title: string;
  value: number;
};

const StatisticCard: React.FC<StatisticCardProps> = ({ title, value }) => {
  return (
    <Card>
      <Statistic title={title} value={value} />
    </Card>
  );
};

export default StatisticCard;

===== END components/dashboard-components/StatisticCard.tsx =====


===== BEGIN components/dashboard-components/style.tsx =====
/**
 * Description: Stylesheet for dashboard components
 * Author: Hieu Chu
 */

import React from 'react'
import { Card, Tooltip, Divider, Col } from 'antd'
import { NumberInfo } from 'ant-design-pro'
import styled from 'styled-components'
import {
  InfoCircleOutlined,
  CaretDownOutlined,
  CaretUpOutlined,
} from '@ant-design/icons'
import * as AntIcons from '@ant-design/icons'

/** helper: map legacy Icon `type` strings (e.g. "shopping-cart") to v4 components */
const legacyTypeToIcon = (type?: string) => {
  if (!type) return null
  const pascal =
    type
      .split('-')
      .map(s => s.charAt(0).toUpperCase() + s.slice(1))
      .join('') + 'Outlined'
  // @ts-ignore dynamic lookup
  return (AntIcons as any)[pascal] || null
}

export const CardStyled = (props: any) => {
  const bodyStyle: React.CSSProperties = {
    padding: '20px 24px 8px',
  }
  if (props.type === 'stats') {
    bodyStyle.padding = '20px 16px 16px'
  }
  return <Card bodyStyle={bodyStyle} bordered={false} {...props} />
}

export const NumberInfoStyled = (props: any) => (
  <NumberInfo
    {...props}
    total={<span style={{ fontSize: 30 }}>{props.total.toLocaleString()}</span>}
    style={{ display: 'inline-block' }}
  />
)

export const HelperIcon = (props: any) => (
  <div style={{ marginLeft: 'auto', alignSelf: 'flex-start' }}>
    <Tooltip {...props} placement="topLeft" arrowPointAtCenter={true}>
      <InfoCircleOutlined style={{ verticalAlign: -3, cursor: 'pointer' }} />
    </Tooltip>
  </div>
)

/**
 * Backward compatible MainIcon.
 * Preferred: <MainIcon icon={<YourIcon />} />
 * Legacy support: <MainIcon type="shopping-cart" />
 */
export const MainIcon = (props: any) => {
  const { icon, type, style, ...rest } = props
  const Resolved = icon
    ? icon
    : (() => {
        const Comp = legacyTypeToIcon(type)
        return Comp ? <Comp /> : null
      })()

  return (
    <div style={{ marginRight: 16 }} {...rest}>
      {React.isValidElement(Resolved)
        ? React.cloneElement(Resolved as React.ReactElement, {
            style: { ...(Resolved.props?.style || {}), ...(style || {}), fontSize: 54 },
          })
        : null}
    </div>
  )
}

export const CardFooter = (props: any) => {
  return (
    <div style={{ position: 'relative', zIndex: 99 }}>
      <span>{props.title}:</span>
      <span style={{ marginLeft: 8, color: 'rgba(0,0,0,.85)' }}>
        {props.value.toLocaleString()}
      </span>
      <Tooltip title="Change compared to yesterday">
        <span style={{ marginLeft: 16 }}>
          <span style={{ color: 'rgba(0,0,0,.55)', marginRight: 2 }}>
            {props.change.toLocaleString()}
          </span>

          {/* Up/down icon */}
          {props.change < 0 ? (
            <CaretDownOutlined style={{ color: '#f5222d', verticalAlign: 'text-bottom' }} />
          ) : (
            <CaretUpOutlined style={{ color: '#52c41a', verticalAlign: 'middle' }} />
          )}
        </span>
      </Tooltip>
    </div>
  )
}

export const ColStyled = styled(Col)`
  padding-bottom: 12px;
`

export const CardDivider = styled(Divider)`
  margin-top: 12px;
  margin-bottom: 9px;
`

export const BarContainer = styled.div`
  height: 90px;
  margin-top: 10px;
  margin-bottom: -10px;
`

export const ShadowCard = styled(CardStyled)`
  box-shadow: rgba(0, 0, 0, 0.06) 0px 9px 24px;
  border-width: 1px;
  border-style: solid;
  border-color: rgb(242, 242, 242);
  border-radius: 3px;
  transition: all 150ms ease-in-out 0s;

  &:hover {
    box-shadow: rgba(0, 0, 0, 0.1) 0px 9px 24px;
    cursor: pointer;
    transition: all 150ms ease-in-out 0s;
  }
`

===== END components/dashboard-components/style.tsx =====


===== BEGIN components/dashboard-components/UserCard.tsx =====
/**
 * Description: User statistics card, including total users and trend graph
 * Author: Hieu Chu
 */

import {
  MainIcon,
  CardDivider,
  NumberInfoStyled,
  CardFooter,
  BarContainer
} from './style'

import dynamic from 'next/dynamic'
const MiniArea = dynamic(
  import('ant-design-pro/lib/Charts').then(mod => mod.MiniArea),
  { ssr: false }
)

export default ({
  TOTAL_USERS,
  DAILY_USERS,
  DAILY_USERS_CHANGE,
  USER_DATA
}) => {
  return (
    <>
      <div style={{ display: 'flex' }}>
        <MainIcon type="team" style={{ color: 'rgb(24, 144, 255)' }} />
        <NumberInfoStyled subTitle="Total users" total={TOTAL_USERS} />
      </div>

      <BarContainer>
        <MiniArea line data={USER_DATA} />
      </BarContainer>

      <CardDivider />

      <CardFooter
        title="Daily users"
        value={DAILY_USERS}
        change={DAILY_USERS_CHANGE}
      />
    </>
  )
}

===== END components/dashboard-components/UserCard.tsx =====


===== BEGIN components/dashboard-components/UserPieChart.tsx =====
'use client'
import React from 'react'
import {
  PieChart, Pie, Cell, Tooltip, ResponsiveContainer, Legend,
} from 'recharts'
import { CardStyled } from './style'

type User = { userId: string }
export default function UserPieChart({ users }: { users: User[] }) {
  const data = [
    { name: 'Email', value: 0 },
    { name: 'Google', value: 0 },
    { name: 'Facebook', value: 0 },
  ]
  for (const u of users) {
    if (u.userId.includes('auth0')) data[0].value++
    else if (u.userId.includes('google')) data[1].value++
    else data[2].value++
  }

  const COLORS = ['#A97BE9', '#EA4335', '#1890FF']

  return (
    <CardStyled title="Proportion of Users">
      <div style={{ width: '100%', height: 294 }}>
        <ResponsiveContainer>
          <PieChart>
            <Pie data={data} dataKey="value" nameKey="name" cx="50%" cy="50%" outerRadius={90} label>
              {data.map((entry, i) => <Cell key={entry.name} fill={COLORS[i % COLORS.length]} />)}
            </Pie>
            <Tooltip />
            <Legend />
          </PieChart>
        </ResponsiveContainer>
      </div>
    </CardStyled>
  )
}

===== END components/dashboard-components/UserPieChart.tsx =====


===== BEGIN components/dashboard-components/VisitCard.tsx =====
import {
  MainIcon,
  CardDivider,
  NumberInfoStyled,
  CardFooter,
  HelperIcon,
  BarContainer
} from './style'

/**
 * Description: Visit statistics card, including total visits and trend graph
 * Author: Hieu Chu
 */

import dynamic from 'next/dynamic'

const MiniArea = dynamic(
  import('ant-design-pro/lib/Charts').then(mod => mod.MiniArea),
  { ssr: false }
)

export default ({
  TOTAL_VISITS,
  DAILY_VISITS,
  DAILY_VISITS_CHANGE,
  VISIT_DATA,
  SINGLE_SCULPTURE
}) => (
  <>
    <div style={{ display: 'flex', alignItems: 'center' }}>
      <MainIcon type="environment" style={{ color: '#F73F3F' }} />
      <NumberInfoStyled subTitle="Total visits" total={TOTAL_VISITS} />
      {!SINGLE_SCULPTURE && (
        <HelperIcon title="Total number of times sculptures have been visited" />
      )}
    </div>

    <BarContainer>
      <MiniArea line data={VISIT_DATA} borderColor="#F73F3F" color="#fff2f0" />
    </BarContainer>

    <CardDivider />

    <CardFooter
      title="Daily visits"
      value={DAILY_VISITS}
      change={DAILY_VISITS_CHANGE}
    />
  </>
)

===== END components/dashboard-components/VisitCard.tsx =====


===== BEGIN components/layout-components/Drawer.tsx =====
'use client'

import React from 'react'
import { Drawer } from 'antd'
import styled from 'styled-components'

/* ------------------------------------------------------------------ */
/*  Drawer stylé : suit les variables CSS du thème et bloque le scroll */
/* ------------------------------------------------------------------ */
const StyledDrawer = styled(Drawer)`
  .ant-drawer-wrapper-body {
    overflow: hidden !important;
  }

  .ant-drawer-content {
    background: var(--ant-color-bg-container) !important;
    color: var(--ant-color-text);
  }
`

interface Props {
  drawerVisible: boolean
  closeDrawer : () => void
  children    : React.ReactNode
}

export default function LayoutDrawer({
  drawerVisible,
  closeDrawer,
  children,
}: Props) {
  return (
    <StyledDrawer
      placement="left"
      closable={false}
      onClose={closeDrawer}
      open={drawerVisible}
        styles={{
			body: {
			margin: 0,
			padding: 0,
			background: 'var(--ant-color-bg-container)',
		},
      }}
    >
      {children}
    </StyledDrawer>
  )
}

===== END components/layout-components/Drawer.tsx =====


===== BEGIN components/layout-components/Header.tsx =====
'use client'

import { Layout, Dropdown, Breadcrumb } from 'antd'
import {
  UserOutlined,
  LogoutOutlined,
  MenuUnfoldOutlined,
  MenuFoldOutlined,
} from '@ant-design/icons'
import styled from 'styled-components'
import Link from 'next/link'
import nookies from 'nookies'
import { useRouter, usePathname } from 'next/navigation'
import { useMemo } from 'react'
import ThemeSwitcher from '@/components/ThemeSwitcher'

const { Header } = Layout

/* -------- styled -------- */
const NavBar = styled.div`
  display: flex;
  align-items: center;
  height: 64px;
  padding: 0 16px;
`

const Crumb = styled(Breadcrumb)`
  margin-left: 20px; /* espace après le toggle */
  color: var(--ant-color-text);
  .ant-breadcrumb-separator {
    color: var(--ant-color-text-secondary);
  }
`

const HeaderBlock = styled.div`
  padding: 0 12px;
  cursor: pointer;
  transition: all 0.3s;
  &:hover {
    background: var(--ant-color-fill-secondary);
  }
`

/* -------- helpers -------- */
const accountItems = [
  { key: 'profile', icon: <UserOutlined />, label: 'Profile' },
  { type: 'divider' as const },
  { key: 'logout', icon: <LogoutOutlined />, label: 'Logout' },
]

interface Route {
  path?: string
  name: string
  views?: Route[]
}

const trail = (rs: Route[], cur: string): Route[] => {
  for (const r of rs) {
    if (r.views?.length) {
      const sub = trail(r.views, cur)
      if (sub.length) return [r, ...sub]
    }
    if (r.path && (cur === r.path || cur.startsWith(r.path))) return [r]
  }
  return []
}

/* -------- component -------- */
interface Props {
  collapsed: boolean
  handleToggle: () => void
  routes?: Route[]
  selectedSidebar?: string
}

export default function HeaderBar({
  collapsed,
  handleToggle,
  routes = [],
  selectedSidebar = '',
}: Props) {
  const router = useRouter()
  const pathname = usePathname() ?? '/'
  const cur = pathname

  const breadcrumbItems = useMemo(() => {
    const br = trail(routes, cur)
    const root = {
      name: selectedSidebar
        ? selectedSidebar[0].toUpperCase() + selectedSidebar.slice(1)
        : '',
      path: `/${selectedSidebar}`,
    }
    const crumbs = br.length ? [root, ...br] : [root]
    return crumbs.map(c => ({
      key: c.path ?? c.name,
      title: c.path ? (
        <Link
          href={{ pathname: c.path, query: { sidebar: selectedSidebar } }}
          style={{ color: 'var(--ant-color-text)' }}
        >
          {c.name}
        </Link>
      ) : (
        <span style={{ color: 'var(--ant-color-text)' }}>{c.name}</span>
      ),
    }))
  }, [routes, cur, selectedSidebar])

  return (
    <Header
      style={{
        position: 'sticky',
        top: 0,
        zIndex: 100,
        background: 'var(--ant-color-bg-container)',
        padding: 0,
        boxShadow: 'var(--ant-box-shadow-secondary)',
      }}
    >
      <NavBar>
        {/* Toggle sidebar */}
        <div
          onClick={handleToggle}
          style={{ cursor: 'pointer', marginRight: 20 }}
        >
          {collapsed ? (
            <MenuUnfoldOutlined style={{ fontSize: 20, color: 'var(--ant-color-text)' }} />
          ) : (
            <MenuFoldOutlined style={{ fontSize: 20, color: 'var(--ant-color-text)' }} />
          )}
        </div>

        {/* Fil d’Ariane */}
        <Crumb items={breadcrumbItems} />

        {/* Zone droite : thème + compte */}
        <div style={{ marginLeft: 'auto', display: 'flex', gap: 8, alignItems: 'center' }}>
          <ThemeSwitcher />

          <Dropdown
            placement="bottomRight"
            menu={{
              items: accountItems,
              onClick: ({ key }) => {
                if (key === 'logout') {
                  nookies.destroy({}, 'auth0.is.authenticated')
                  nookies.destroy({}, 'accessToken')
                  router.push('/')
                } else if (key === 'profile') {
                  router.push('/users/id/123')
                }
              },
            }}
          >
            <HeaderBlock>
              <UserOutlined style={{ marginRight: 8, color: 'var(--ant-color-text)' }} /> Admin
            </HeaderBlock>
          </Dropdown>
        </div>
      </NavBar>
    </Header>
  )
}

===== END components/layout-components/Header.tsx =====


===== BEGIN components/layout-components/LogoTitle.tsx =====
// File: /components/layout-components/LogoTitle.tsx
'use client'

import styled from 'styled-components'
import { Dropdown } from 'antd'

/* ------------ styled ------------ */
export const Logo = styled.img`
  display: block;
  height: 32px;
  vertical-align: middle;
`

const Title = styled.span`
  display: inline-block;
  color: var(--ant-color-text);
  font-weight: 600;
  font-size: 20px;
  margin-left: 12px;
  font-family: 'Arial';
  vertical-align: middle;
`

const TitleWrapper = styled.div`
  position: relative;
  height: 64px;
  padding-left: 24px;
  overflow: hidden;
  line-height: 64px;
  transition: background 0.3s ease;
  background: var(--ant-color-bg-container);
`

const LogoContainer = styled.div`
  display: flex;
  align-items: center;
  cursor: pointer;
`

/* ------------ mapping du label par sidebar ------------ */
const titleMapping = {
  ekoh        : 'EkoH',
  ethikos     : 'EthiKos',
  keenkonnect : 'keenKonnect',
  konnected   : 'KonnectED',
  kreative    : 'Kreative',
} as const

interface Props {
  onSidebarChange : (key: string) => void
  selectedSidebar?: string
}

/* ------------ composant ------------ */
export default function LogoTitle({
  onSidebarChange,
  selectedSidebar,
}: Props) {
  const sidebar = selectedSidebar?.toLowerCase() ?? 'ekoh'

  const menuItems = Object.entries(titleMapping).map(([key, label]) => ({
    key, label,
  }))

  return (
    <TitleWrapper>
      <Dropdown
        trigger={['click']}
        menu={{
          items: menuItems,
          onClick: ({ key }) => onSidebarChange(key),
          // **ici on force un fond opaque + ombre**
          style: {
            background: 'var(--ant-color-bg-container)',
            boxShadow: 'var(--ant-box-shadow-secondary)',
          },
        }}
      >
        <LogoContainer>
          <Logo src="/LogoK.svg" alt="Konnaxion logo" />
          <Title>
            {titleMapping[sidebar as keyof typeof titleMapping] ?? 'UOW Sculptures'}
          </Title>
        </LogoContainer>
      </Dropdown>
    </TitleWrapper>
  )
}

===== END components/layout-components/LogoTitle.tsx =====


===== BEGIN components/layout-components/Main.tsx =====
'use client'

import { Layout } from 'antd'
import styled, { css } from 'styled-components'

const StyledMain = styled(
  ({ collapsed: _c, ...rest }) => <Layout {...rest} />,
)<{ collapsed: boolean }>`
  transition: 0.2s all;

  /* décalage = largeur réelle du sider (ouvert) */
  margin-left: 256px;

  background: var(--ant-color-bg-layout);

  /* décalage quand le sider est réduit */
  ${({ collapsed }) =>
    collapsed &&
    css`
      margin-left: 80px;
    `}

  @media (max-width: 575.98px) {
    margin-left: 0;
  }
`

export default function Main({
  children,
  collapsed,
}: {
  children: React.ReactNode
  collapsed: boolean
}) {
  return <StyledMain collapsed={collapsed}>{children}</StyledMain>
}

===== END components/layout-components/Main.tsx =====


===== BEGIN components/layout-components/MainLayout.tsx =====
'use client'

import React, { useState, useEffect } from 'react'
import { Layout } from 'antd'
import { useRouter, usePathname, useSearchParams } from 'next/navigation'

import FixedSider      from '@/components/layout-components/Sider'
import Main            from '@/components/layout-components/Main'
import HeaderComponent from '@/components/layout-components/Header'
import LogoTitle       from '@/components/layout-components/LogoTitle'
import DrawerComponent from '@/components/layout-components/Drawer'
import MenuComponent   from '@/components/layout-components/Menu'
import type { Route }  from '@/components/layout-components/Menu'

interface RoutesConfig {
  ekoh: Route[]
  ethikos: Route[]
  keenkonnect: Route[]
  konnected: Route[]
  kreative: Route[]
}

const { Content } = Layout

export default function MainLayout({
  collapsed: initialCollapsed = false,
  children,
}: React.PropsWithChildren<{ collapsed?: boolean }>) {
  const router   = useRouter()
  const pathname = usePathname()
  const q        = useSearchParams()

  /* états */
  const [collapsed, setCollapsed] = useState(initialCollapsed)
  const [drawerVisible, setDrawer] = useState(false)

  const [routes, setRoutes] = useState<RoutesConfig>({
    ekoh: [], ethikos: [], keenkonnect: [], konnected: [], kreative: [],
  })

  /* suite depuis ?sidebar= */
  const [suite, setSuite] = useState(q.get('sidebar') ?? 'ekoh')

  /* charger dynamiquement les routes */
  useEffect(() => {
    Promise.all([
      import('@/routes/routesEkoh'),
      import('@/routes/routesEthikos'),
      import('@/routes/routesKeenkonnect'),
      import('@/routes/routesKonnected'),
      import('@/routes/routesKreative'),
    ])
      .then(([
        { default: ekoh },
        { default: ethikos },
        { default: keen },
        { default: konnected },
        { default: kreative },
      ]) => setRoutes({ ekoh, ethikos, keenkonnect: keen, konnected, kreative }))
      .catch(err => console.error('Erreur chargement routes :', err))
  }, [])

  /* sync si ?sidebar change */
  useEffect(() => {
    const v = q.get('sidebar')
    if (v && v !== suite) setSuite(v)
  }, [q])

  const changeSuite = (key: string) => {
    setSuite(key)
    const params = new URLSearchParams(Array.from(q.entries()))
    params.set('sidebar', key)
    router.push(`${pathname}?${params.toString()}`)
  }

  const toggle = () => {
    if (window.innerWidth >= 576) setCollapsed(!collapsed)
    else setDrawer(v => !v)
  }

  const suiteRoutes = routes[suite as keyof RoutesConfig] ?? []

  return (
    <Layout style={{ minHeight: '100vh', background: 'var(--ant-layout-color-bg-layout)' }}>
      {/* SIDEBAR desktop */}
      <FixedSider collapsed={collapsed} setCollapsed={setCollapsed}>
        <LogoTitle onSidebarChange={changeSuite} selectedSidebar={suite} />
        <MenuComponent
          routes={suiteRoutes}
          closeDrawer={() => setDrawer(false)}
          selectedSidebar={suite}
        />
      </FixedSider>

      {/* MAIN + HEADER */}
      <Main collapsed={collapsed}>
        <HeaderComponent
          collapsed={collapsed}
          handleToggle={toggle}
          routes={suiteRoutes}
          selectedSidebar={suite}
        />
        <Content
          style={{
            margin      : '20px 16px 15px 16px',
            background  : 'var(--ant-color-bg-container)',
            borderRadius: 8,
          }}
        >
          {children}
        </Content>
      </Main>

      {/* DRAWER mobile */}
      <DrawerComponent
        drawerVisible={drawerVisible}
        closeDrawer={() => setDrawer(false)}
      >
        <LogoTitle onSidebarChange={changeSuite} selectedSidebar={suite} />
        <MenuComponent
          routes={suiteRoutes}
          style={{ minHeight: '100vh' }}
          closeDrawer={() => setDrawer(false)}
          selectedSidebar={suite}
        />
      </DrawerComponent>
    </Layout>
  )
}

===== END components/layout-components/MainLayout.tsx =====


===== BEGIN components/layout-components/Menu.tsx =====
'use client'

import React from 'react'
import { Menu } from 'antd'
import { usePathname } from 'next/navigation'
import Link from 'next/link'

export interface Route {
  path?: string
  name: string
  icon?: React.ReactNode
  views?: Route[]
}

interface Props {
  routes: Route[]
  style?: React.CSSProperties
  closeDrawer: () => void
  selectedSidebar: string
}

const MenuComponent: React.FC<Props> = ({
  routes,
  style,
  closeDrawer,
  selectedSidebar,
}) => {
  const pathname = usePathname()

  /* helpers */
  const toItems = (rs: Route[]): any[] =>
    rs
      .map(r =>
        r.views?.length
          ? {
              key: r.name,
              icon: r.icon,
              label: r.name,
              children: toItems(r.views),
            }
          : r.path
          ? {
              key: r.path,
              icon: r.icon,
              label: (
                <Link
                  href={{ pathname: r.path, query: { sidebar: selectedSidebar } }}
                  onClick={closeDrawer}
                >
                  {r.name}
                </Link>
              ),
            }
          : null,
      )
      .filter(Boolean)

  const flatten = (rs: Route[]): Route[] =>
    rs.flatMap(r => (r.views?.length ? flatten(r.views) : [r]))

  const selectedKeys = flatten(routes)
    .filter(r => r.path && pathname.startsWith(r.path!))
    .map(r => r.path!)

  return (
    <Menu
      mode="inline"
      selectedKeys={selectedKeys}
      items={toItems(routes)}
      style={{
        background: 'var(--ant-color-bg-container)',
        color     : 'var(--ant-color-text)',
        padding   : '16px 0',
        ...style,
      }}
    />
  )
}

export default MenuComponent

===== END components/layout-components/Menu.tsx =====


===== BEGIN components/layout-components/Sider.tsx =====
'use client'

import { Layout } from 'antd'
import styled     from 'styled-components'

const { Sider } = Layout

/* Sider fixe alimenté par les variables Ant Design */
const FixedSider = styled(Sider)`
  background : var(--ant-color-bg-container) !important;
  overflow   : auto;
  height     : 100vh;
  position   : fixed;
  left       : 0;
  box-shadow : var(--ant-box-shadow-secondary, 2px 0 6px rgba(0, 21, 41, .35));
  transition : background 0.3s ease;

  @media (max-width: 575.98px) {
    display: none;
  }
`

interface Props {
  collapsed    : boolean
  setCollapsed : (c: boolean) => void
  children     : React.ReactNode
}

export default function SiderWrapper({
  collapsed,
  setCollapsed,
  children,
}: Props) {
  return (
    <FixedSider
      trigger={null}
      width={256}
      collapsible
      collapsed={collapsed}
      breakpoint="lg"
      onBreakpoint={setCollapsed}
    >
      {children}
    </FixedSider>
  )
}

===== END components/layout-components/Sider.tsx =====


===== BEGIN components/map-components/ControlPanel.tsx =====
/**
 * Description: Helper control panel in Map view to show current co-ordinates of marker
 * Author: Hieu Chu
 */

import React, { PureComponent } from 'react'

export default class ControlPanel extends PureComponent {
  render() {
    const { lat, lng } = this.props
    return (
      <div className="control-panel">
        <div>Latitude: {lat}</div>
        <div>Longitude: {lng}</div>
      </div>
    )
  }
}

===== END components/map-components/ControlPanel.tsx =====


===== BEGIN components/map-components/index.tsx =====
import Map from './Map'

export default Map

===== END components/map-components/index.tsx =====


===== BEGIN components/map-components/Map.tsx =====
/**
 * Description: Dynamic map view with support for geolocation control and draggable marker
 * Author: Hieu Chu
 */

import ReactMapGL, {
  Marker,
  NavigationControl,
  FullscreenControl,
  GeolocateControl
} from 'react-map-gl'

import 'mapbox-gl/dist/mapbox-gl.css'
import MapMarker from './MapMarker'
import ControlPanel from './ControlPanel'

const fullscreenControlStyle = {
  position: 'absolute',
  top: 0,
  left: 0,
  padding: '10px'
}

const navStyle = {
  position: 'absolute',
  top: 36,
  left: 0,
  padding: '10px'
}

const geolocateStyle = {
  position: 'absolute',
  bottom: 30,
  right: 0,
  margin: 10
}

const Map = ({ view, setView, marker, setMarker }) => {
  const token = process.env.MAPBOX_ACCESS_TOKEN
  const { markerLat, markerLng } = marker

  return (
    <ReactMapGL
      {...view}
      width="100%"
      height="100%"
      mapboxApiAccessToken={token}
      mapStyle="mapbox://styles/mapbox/streets-v11"
      onViewportChange={viewport => setView({ ...view, ...viewport })}
      onClick={e => console.log(e)}
    >
      <Marker
        longitude={markerLng}
        latitude={markerLat}
        draggable
        onDragEnd={({ lngLat: [markerLng, markerLat] }) =>
          setMarker({ markerLat, markerLng })
        }
      >
        <MapMarker size={22} />
      </Marker>

      <div className="fullscreen" style={fullscreenControlStyle}>
        <FullscreenControl />
      </div>
      <div className="nav" style={navStyle}>
        <NavigationControl />
      </div>

      <GeolocateControl
        style={geolocateStyle}
        positionOptions={{ enableHighAccuracy: true }}
        trackUserLocation
        showUserLocation
        onViewportChange={viewport =>
          setView({ ...view, ...viewport, zoom: 13 })
        }
      />

      <ControlPanel lat={markerLat} lng={markerLng} />
    </ReactMapGL>
  )
}

export default Map

===== END components/map-components/Map.tsx =====


===== BEGIN components/map-components/MapMarker.tsx =====
/**
 * Description: Marker custom icon
 * Author: Hieu Chu
 */

import React, { PureComponent } from 'react'

const ICON = `M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3
  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9
  C20.1,15.8,20.2,15.8,20.2,15.7z`

const pinStyle = {
  fill: '#FF0000',
  stroke: 'none',
  transform: 'translate(-50%,-100%)'
}

export default class MapMarker extends PureComponent {
  render() {
    const { size = 20 } = this.props

    return (
      <svg height={size} viewBox="0 0 24 24" style={pinStyle}>
        <path d={ICON} />
      </svg>
    )
  }
}

===== END components/map-components/MapMarker.tsx =====


===== BEGIN components/map-components/StaticMap.tsx =====
'use client'

/**
 * Description: Static map view
 * Author: Hieu Chu
 */

import ReactMapGL, {
  Marker,
  FullscreenControl,
  Popup,
  GeolocateControl
} from 'react-map-gl'

import { useState } from 'react'
import 'mapbox-gl/dist/mapbox-gl.css'
import MapMarker from './MapMarker'

const fullscreenControlStyle = {
  position: 'absolute',
  top: 0,
  left: 0,
  padding: '10px'
}

const geolocateStyle = {
  position: 'absolute',
  bottom: 30,
  right: 0,
  margin: 10
}

const defaultLocation = {
  latitude: -34.40581053569814,
  longitude: 150.87842788963476
}

const MyStaticMap = ({ markerLat, markerLng }) => {
  const token = process.env.MAPBOX_ACCESS_TOKEN
  const [vp, setVp] = useState({
    latitude: markerLat ? markerLat : defaultLocation.latitude,
    longitude: markerLng ? markerLng : defaultLocation.longitude,
    zoom: 15,
    pitch: 50
  })

  return (
    <ReactMapGL
      {...vp}
      width="100%"
      height="640px"
      mapboxApiAccessToken={token}
      mapStyle="mapbox://styles/mapbox/streets-v11"
      onViewportChange={viewport => {
        setVp(vp => ({ ...vp, ...viewport }))
      }}
    >
      <div>
        {markerLat && (
          <>
            <Marker longitude={markerLng} latitude={markerLat}>
              <MapMarker size={22} />
            </Marker>

            <Popup
              tipSize={5}
              anchor="bottom"
              latitude={markerLat}
              longitude={markerLng}
              closeOnClick={false}
              offsetTop={-20}
              closeButton={false}
            >
              <div
                style={{
                  marginLeft: 5,
                  marginRight: 5
                }}
              >
                <div>Latitude: {markerLat}</div>
                <div>Longitude: {markerLng}</div>
              </div>
            </Popup>
          </>
        )}

        <div className="fullscreen" style={fullscreenControlStyle}>
          <FullscreenControl />
        </div>

        <GeolocateControl
          style={geolocateStyle}
          positionOptions={{ enableHighAccuracy: true }}
          trackUserLocation
          showUserLocation
          onViewportChange={viewport =>
            setVp(vp => ({ ...vp, ...viewport, zoom: 14 }))
          }
        />
      </div>
    </ReactMapGL>
  )
}

export default MyStaticMap

===== END components/map-components/StaticMap.tsx =====


===== BEGIN components/PageContainer.tsx =====
'use client'

import React, { ReactNode } from 'react'
import styled from 'styled-components'

interface PageContainerProps {
  title: string
  children: ReactNode
}

const Container = styled.div`
  padding: var(--ant-space-lg);
  background: var(--ant-color-bg-container);
  color: var(--ant-color-text);
`

const Header = styled.header`
  border-bottom: 1px solid var(--ant-color-split);
  margin-bottom: var(--ant-space-lg);
`

const Title = styled.h1`
  margin: 0;
  color: var(--ant-color-text);
`

export default function PageContainer({
  title,
  children,
}: PageContainerProps) {
  return (
    <Container>
      <Header>
        <Title>{title}</Title>
      </Header>
      <main>{children}</main>
    </Container>
  )
}

===== END components/PageContainer.tsx =====


===== BEGIN components/sculpture-maker-components/CreateForm/CreateFormTextFields.tsx =====
'use client'

/**
 * Description: Sculpture create text fields component
 * Author: Hieu Chu
 */

import { useState } from 'react'
import { Input, Icon, Select, Divider } from 'antd'
const { TextArea } = Input
import { FormCol, CustomFormItem } from '../style'
import { validateLatitude, validateLongitude } from '../../shared/utils'
import MakerCreate from './MakerCreate'

const { Option } = Select

export default ({
  getFieldDecorator,
  initialData: { markerLat, markerLng },
  makerList,
  addMaker
}) => {
  const [showModal, setShowModal] = useState(false)

  const openModal = () => setShowModal(true)
  const handleCancel = () => setShowModal(false)

  return (
    <>
      <FormCol>
        <CustomFormItem label="Sculpture name" hasFeedback>
          {getFieldDecorator('name', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the sculpture name!'
              }
            ]
          })(
            <Input
              prefix={
                <Icon type="trophy" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Sculpture name"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Accession ID" hasFeedback>
          {getFieldDecorator('accessionId', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the unique accession ID!'
              }
            ]
          })(
            <Input
              prefix={
                <Icon type="number" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Accession ID"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Primary maker" hasFeedback>
          {getFieldDecorator('primaryMakerId', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the primary maker!'
              }
            ]
          })(
            <Select
              placeholder="Primary maker"
              dropdownRender={menu => (
                <div>
                  {menu}
                  <Divider style={{ margin: '4px 0' }} />
                  <div
                    style={{ padding: '8px', cursor: 'pointer' }}
                    onMouseDown={e => e.preventDefault()} // fix
                    onClick={openModal}
                  >
                    <Icon type="plus" /> Add new maker
                  </div>
                </div>
              )}
            >
              {makerList.map(maker => (
                <Option key={maker.id} value={maker.id}>
                  {maker.firstName + ' ' + maker.lastName}
                </Option>
              ))}
            </Select>
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Production date" hasFeedback>
          {getFieldDecorator('productionDate')(
            <Input
              prefix={
                <Icon type="calendar" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Production date"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Material" hasFeedback>
          {getFieldDecorator('material')(
            <Input
              prefix={
                <Icon
                  type="code-sandbox"
                  style={{ color: 'rgba(0,0,0,.25)' }}
                />
              }
              type="text"
              placeholder="Material"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Credit line" hasFeedback>
          {getFieldDecorator('creditLine')(
            <TextArea
              placeholder="Credit line"
              autosize={{ minRows: 3, maxRows: 5 }}
              style={{ marginTop: 5 }}
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Location details" hasFeedback>
          {getFieldDecorator('locationNotes')(
            <TextArea
              placeholder="Location details"
              autosize={{ minRows: 3, maxRows: 5 }}
              style={{ marginTop: 5 }}
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol xs={24} sm={12}>
        <CustomFormItem label="Latitude" hasFeedback className="latitude-input">
          {getFieldDecorator('latitude', {
            rules: [
              {
                validator: validateLatitude
              }
            ],
            initialValue: String(markerLat)
          })(
            <Input
              prefix={
                <Icon type="compass" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Latitude"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol xs={24} sm={12}>
        <CustomFormItem
          label="Longitude"
          hasFeedback
          className="longitude-input"
        >
          {getFieldDecorator('longitude', {
            rules: [
              {
                validator: validateLongitude
              }
            ],
            initialValue: String(markerLng)
          })(
            <Input
              prefix={
                <Icon type="compass" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Longitude"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <MakerCreate
        visible={showModal}
        handleCancel={handleCancel}
        addMaker={addMaker}
      />
    </>
  )
}

===== END components/sculpture-maker-components/CreateForm/CreateFormTextFields.tsx =====


===== BEGIN components/sculpture-maker-components/CreateForm/index.tsx =====
'use client'

/**
 * Description: Sculpture create page component
 * Author: Hieu Chu
 */

import { useState } from 'react'
import SculptureCreate from './SculptureCreate'
import SculptureUploadImage from './SculptureUploadImage'
const CreateForm = () => {
  const [step, setStep] = useState(1)
  const [sculpture, setSculpture] = useState({})

  if (step === 1) {
    return <SculptureCreate setStep={setStep} setSculpture={setSculpture} />
  } else if (step === 2) {
    return <SculptureUploadImage sculpture={sculpture} />
  }
}

export default CreateForm

===== END components/sculpture-maker-components/CreateForm/index.tsx =====


===== BEGIN components/sculpture-maker-components/CreateForm/MakerCreate.tsx =====
'use client'

/**
 * Description: Component for primary maker create page
 * Author: Hieu Chu
 */

import { useState } from 'react'
import { Input, Form, Button, Modal, message } from 'antd'
import { CustomFormItem } from '../style'
import api from '../../../api'

const MakerCreate = ({
  form: { getFieldDecorator, validateFields, resetFields },
  visible,
  handleCancel,
  addMaker
}) => {
  const [submitting, setSubmitting] = useState(false)

  const handleOk = e => {
    e.preventDefault()
    validateFields(async (err, values) => {
      if (!err) {
        console.log('Received values of form: ', values)
        for (let key in values) {
          if (!values[key]) {
            delete values[key]
          }
        }

        if (values.birthYear) {
          values.birthYear = Number(values.birthYear)
        }
        if (values.deathYear) {
          values.deathYear = Number(values.deathYear)
        }

        setSubmitting(true)
        try {
          const result = (await api.post('/maker', values)).data
          addMaker(result)
          setSubmitting(false)
          handleCancel()
          resetFields()
          message.success('Created new maker succesfully!', 2)
        } catch (e) {
          setSubmitting(false)
          message.error(e.response.data.message)
        }
      }
    })
  }

  return (
    <Modal
      open={visible}
      title="Add new maker"
      onOk={handleOk}
      onCancel={handleCancel}
      maskClosable={false}
      footer={[
        <Button key="back" onClick={handleCancel}>
          Cancel
        </Button>,
        <Button
          key="submit"
          type="primary"
          loading={submitting}
          onClick={handleOk}
        >
          Submit
        </Button>
      ]}
    >
      <Form autoComplete="off">
        <CustomFormItem label="First name" hasFeedback>
          {getFieldDecorator('firstName', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the first name!'
              }
            ]
          })(<Input type="text" placeholder="First name" />)}
        </CustomFormItem>

        <CustomFormItem label="Last name" hasFeedback>
          {getFieldDecorator('lastName', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the last name!'
              }
            ]
          })(<Input type="text" placeholder="Last name" />)}
        </CustomFormItem>

        <CustomFormItem label="Nationality" hasFeedback>
          {getFieldDecorator('nationality')(
            <Input type="text" placeholder="Nationality" />
          )}
        </CustomFormItem>

        <CustomFormItem label="Born" hasFeedback>
          {getFieldDecorator('birthYear', {
            rules: [
              {
                pattern: '^[0-9]{4}$',
                message: 'Please fill in a valid year!'
              }
            ]
          })(<Input type="text" placeholder="Born" />)}
        </CustomFormItem>

        <CustomFormItem label="Passed away" hasFeedback>
          {getFieldDecorator('deathYear', {
            rules: [
              {
                pattern: '^[0-9]{4}$',
                message: 'Please fill in a valid year!'
              }
            ]
          })(<Input type="text" placeholder="Passed away" />)}
        </CustomFormItem>

        <CustomFormItem label="Website" hasFeedback>
          {getFieldDecorator('wikiUrl', {
            rules: [
              {
                type: 'url',
                message: 'Please fill in a valid URL!'
              }
            ]
          })(<Input type="text" placeholder="Website" />)}
        </CustomFormItem>
      </Form>
    </Modal>
  );
}

export default Form.create({
  name: 'maker_create_form'
})(MakerCreate)

===== END components/sculpture-maker-components/CreateForm/MakerCreate.tsx =====


===== BEGIN components/sculpture-maker-components/CreateForm/SculptureCreate.tsx =====
'use client'

/**
 * Description: Component for Sculpture create page
 * Author: Hieu Chu
 */

import { useState, useEffect } from 'react'
import { Row, Button, Form, message } from 'antd'
import { ColStyled, CardStyled, FormCol, CustomFormItem } from '../style'
import { FlyToInterpolator } from 'react-map-gl'
import Map from '../../map-components'
import TextFields from './CreateFormTextFields'
import api from '../../../api'
import Loading from '../../Loading'
import Error from 'next/error'

const SculptureCreate = ({
  form,
  form: { getFieldDecorator, setFieldsValue },
  setStep,
  setSculpture
}) => {
  const [view, setView] = useState({
    latitude: -34.40581053569814,
    longitude: 150.87842788963476,
    zoom: 15,
    pitch: 50
  })

  const initialData = {
    markerLat: -34.40581053569814,
    markerLng: 150.87842788963476
  }

  const [marker, setMarker] = useState({
    ...initialData
  })

  const [makerList, setMakerList] = useState([])
  const [loading, setLoading] = useState(true)
  const [submitting, setSubmitting] = useState(false)
  const [error, setError] = useState(null)

  const addMaker = maker => {
    setMakerList([...makerList, maker])
    setFieldsValue({
      primaryMakerId: maker.id
    })
  }

  useEffect(() => {
    const fetchMakerList = async () => {
      try {
        const data = (await api.get('/maker/')).data
        console.log(data)
        setMakerList(data)
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }
    fetchMakerList()
  }, [])

  const flyTo = (latitude, longitude) => {
    setView({
      ...view,
      latitude,
      longitude,
      transitionInterpolator: new FlyToInterpolator(),
      transitionDuration: 1500,
      zoom: 15
    })

    setMarker({
      markerLat: latitude,
      markerLng: longitude
    })
  }

  const showLocationOnMap = () => {
    form.validateFields(['latitude', 'longitude'], (errors, values) => {
      if (!errors) {
        const { latitude, longitude } = values
        flyTo(+latitude, +longitude)
      }
    })
  }

  const handleSubmit = e => {
    e.preventDefault()
    form.validateFields(async (err, values) => {
      if (!err) {
        // remember to convert lat and long to numeric type
        console.log('Received values of form: ', values)
        for (let key in values) {
          if (!values[key]) {
            delete values[key]
          }
        }

        if (values.latitude) {
          values.latitude = Number(values.latitude)
        }

        if (values.longitude) {
          values.longitude = Number(values.longitude)
        }

        console.log('after', values)

        setSubmitting(true)
        try {
          const _result = (await api.post('/sculpture', values)).data
          setSubmitting(false)
          setSculpture({ ...values })
          setStep(s => s + 1)
        } catch (e) {
          setSubmitting(false)
          message.error(e.response.data.message)
        }
      }
    })
  }

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  return (
    <Row gutter={16}>
      <ColStyled xs={24}>
        <CardStyled title="Create new sculpture">
          <Form onSubmit={handleSubmit} autoComplete="off">
            <ColStyled xs={24} md={12}>
              {/* long repeated list of text fields */}
              <TextFields
                getFieldDecorator={getFieldDecorator}
                initialData={initialData}
                makerList={makerList}
                addMaker={addMaker}
              />
              <FormCol xs={24}>
                <Button onClick={showLocationOnMap}>Show on map</Button>
              </FormCol>
            </ColStyled>

            <ColStyled
              xs={24}
              md={12}
              style={{
                height: 500,
                marginTop: 10
              }}
            >
              <Map
                view={view}
                marker={marker}
                setView={setView}
                setMarker={({ markerLat, markerLng }) => {
                  setMarker({ markerLat, markerLng })
                  setFieldsValue({
                    latitude: String(markerLat),
                    longitude: String(markerLng)
                  })
                }}
              />
            </ColStyled>

            <ColStyled xs={24}>
              <FormCol xs={24}>
                <CustomFormItem style={{ marginBottom: 0, marginTop: 8 }}>
                  <Button type="primary" htmlType="submit" loading={submitting}>
                    Submit
                  </Button>
                </CustomFormItem>
              </FormCol>
            </ColStyled>
          </Form>
        </CardStyled>
      </ColStyled>
    </Row>
  )
}

export default Form.create({
  name: 'sculpture_create_form'
})(SculptureCreate)

===== END components/sculpture-maker-components/CreateForm/SculptureCreate.tsx =====


===== BEGIN components/sculpture-maker-components/CreateForm/SculptureUploadImage.tsx =====
'use client';

/**
 * Description: Upload image component when creating new sculpture
 * Author: Hieu Chu
 */

import { Upload, Button, Icon, message, Row, Modal } from 'antd'
import { useState } from 'react'
import { CardStyled, ColStyled } from '../style'
import api from '../../../api'
import { useRouter } from 'next/navigation';
import Head from 'next/head'

const { confirm } = Modal

const defaultFileList = []

const SculptureUploadImage = ({ sculpture }) => {
  const [fileList, setFileList] = useState([...defaultFileList])
  const { accessionId, name } = sculpture

  const handleRemove = file => {
    return new Promise((resolve, _reject) => {
      confirm({
        title: 'Do you want to remove this image?',
        icon: <Icon type="exclamation-circle" style={{ color: '#ff4d4f' }} />,
        style: { top: 110 },
        maskClosable: true,
        okText: 'Confirm',
        okButtonProps: {
          style: {
            background: '#ff4d4f',
            borderColor: '#ff4d4f'
          }
        },
        onOk: async () => {
          try {
            const _result = await api.delete(`/sculpture-images/${file.uid}`)
            resolve(true)
            setFileList(fileList => fileList.filter(x => x.uid !== file.uid))
            message.success('Deleted image successfully!', 2)
          } catch (error) {
            message.error(error.response.data.message)
            resolve(false)
          }
        },
        onCancel: () => {
          resolve(false)
        }
      })
    })
  }

  const customRequest = async e => {
    const config = {
      headers: {
        'content-type':
          'multipart/form-data; boundary=----WebKitFormBoundaryqTqJIxvkWFYqvP5s'
      },
      onUploadProgress: function(progressEvent) {
        var percentCompleted = Math.round(
          (progressEvent.loaded * 100) / progressEvent.total
        )
        e.onProgress(percentCompleted)
      }
    }

    let data = new FormData()
    data.append('images', e.file)
    data.set('accessionId', accessionId)
    const hide = message.loading('Uploading image...', 0)

    try {
      const _result = await api.post('/sculpture-images', data, config)
      const file = { ...e.file }
      const { id, url } = _result.data[0]
      file.uid = id
      file.url = url
      file.thumbUrl = url
      file.preview = url
      setFileList(fileList => [...fileList, file])

      e.onSuccess(_result.data[0], e.file)
      hide()
      message.success('Uploaded image successfully!', 2)
    } catch (error) {
      message.error(error.response.data.message)
      e.onError(error.response.data.message)
    }
  }

  const uploadButton = (
    <div>
      <Icon type="plus" />
      <div className="ant-upload-text">Upload</div>
    </div>
  )

  return (
    <>
      <Head>
        <title>Upload images - UOW Sculptures</title>
      </Head>
      <Row gutter={16}>
        <ColStyled xs={24}>
          <CardStyled title={`Upload sculpture image for ${name}`}>
            <Upload
              defaultFileList={[...defaultFileList]}
              accept="image/*"
              listType="picture-card"
              customRequest={customRequest}
              onRemove={handleRemove}
              fileList={fileList}
            >
              {uploadButton}
            </Upload>

            <Button
              type="primary"
              onClick={() =>
                router.push(`/sculptures/id/${accessionId}`)
              }
            >
              Finish
            </Button>
          </CardStyled>
        </ColStyled>
      </Row>
    </>
  );
}

export default SculptureUploadImage

===== END components/sculpture-maker-components/CreateForm/SculptureUploadImage.tsx =====


===== BEGIN components/sculpture-maker-components/EditForm/EditFormTextFields.tsx =====
'use client'

/**
 * Description: Text details edit component for sculpture
 * Author: Hieu Chu
 */

import { useState } from 'react'
import { Input, Icon, Select, Divider } from 'antd'
const { TextArea } = Input
import { FormCol, CustomFormItem } from '../style'
import { validateLatitude, validateLongitude } from '../../shared/utils'
import MakerEdit from './MakerEdit'
import MakerCreate from '../CreateForm/MakerCreate'

const { Option } = Select

export default ({
  getFieldDecorator,
  setFieldsValue,
  getFieldValue,
  initialData: {
    latitude,
    longitude,
    accessionId,
    creditLine,
    locationNotes,
    material,
    name,
    productionDate,
    primaryMakerId
  },
  makerList,
  setMakerList
}) => {
  const [showModal, setShowModal] = useState(false)
  const [showModalCreate, setShowModalCreate] = useState(false)

  const openModal = () => setShowModal(true)
  const handleCancel = () => setShowModal(false)

  const openModalCreate = () => setShowModalCreate(true)
  const handleCancelCreate = () => setShowModalCreate(false)

  const getCurrentMaker = () => {
    return makerList.find(x => x.id === getFieldValue('primaryMakerId'))
  }

  const addMaker = maker => {
    setMakerList(c => [...c, maker])
    setFieldsValue({
      primaryMakerId: maker.id
    })
  }

  const editMaker = maker => {
    setMakerList(c =>
      c.map(m => {
        if (m.id !== maker.id) {
          return m
        }

        return { ...maker }
      })
    )
    setFieldsValue({
      primaryMakerId: maker.id
    })
  }

  return (
    <>
      <FormCol>
        <CustomFormItem label="Sculpture name" hasFeedback>
          {getFieldDecorator('name', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the sculpture name!'
              }
            ],
            initialValue: name
          })(
            <Input
              prefix={
                <Icon type="trophy" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Sculpture name"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Accession ID" hasFeedback>
          {getFieldDecorator('accessionId', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the unique accession ID!'
              }
            ],
            initialValue: accessionId
          })(
            <Input
              prefix={
                <Icon type="number" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Accession ID"
              // disabled
              readOnly
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Primary maker" hasFeedback>
          {getFieldDecorator('primaryMakerId', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the primary maker!'
              }
            ],
            initialValue: primaryMakerId
          })(
            <Select
              placeholder="Primary maker"
              dropdownRender={menu => (
                <div>
                  {menu}
                  <Divider style={{ margin: '4px 0' }} />
                  <div
                    style={{ padding: '8px', cursor: 'pointer' }}
                    onMouseDown={e => e.preventDefault()} // fix
                    onClick={openModal}
                  >
                    <Icon type="edit" /> Edit current maker
                  </div>
                  <div
                    style={{ padding: '8px', cursor: 'pointer' }}
                    onMouseDown={e => e.preventDefault()} // fix
                    onClick={openModalCreate}
                  >
                    <Icon type="plus" /> Add new maker
                  </div>
                </div>
              )}
            >
              {makerList.map(maker => (
                <Option key={maker.id} value={maker.id}>
                  {maker.firstName + ' ' + maker.lastName}
                </Option>
              ))}
            </Select>
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Production date" hasFeedback>
          {getFieldDecorator('productionDate', {
            initialValue: productionDate
          })(
            <Input
              prefix={
                <Icon type="calendar" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Production date"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Material" hasFeedback>
          {getFieldDecorator('material', {
            initialValue: material
          })(
            <Input
              prefix={
                <Icon
                  type="code-sandbox"
                  style={{ color: 'rgba(0,0,0,.25)' }}
                />
              }
              type="text"
              placeholder="Material"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Credit line" hasFeedback>
          {getFieldDecorator('creditLine', {
            initialValue: creditLine
          })(
            <TextArea
              placeholder="Credit line"
              autosize={{ minRows: 3, maxRows: 5 }}
              style={{ marginTop: 5 }}
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol>
        <CustomFormItem label="Location details" hasFeedback>
          {getFieldDecorator('locationNotes', {
            initialValue: locationNotes
          })(
            <TextArea
              placeholder="Location details"
              autosize={{ minRows: 3, maxRows: 5 }}
              style={{ marginTop: 5 }}
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol xs={24} sm={12}>
        <CustomFormItem label="Latitude" hasFeedback className="latitude-input">
          {getFieldDecorator('latitude', {
            rules: [
              {
                validator: validateLatitude
              }
            ],
            initialValue: latitude ? String(latitude) : ''
          })(
            <Input
              prefix={
                <Icon type="compass" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Latitude"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <FormCol xs={24} sm={12}>
        <CustomFormItem
          label="Longitude"
          hasFeedback
          className="longitude-input"
        >
          {getFieldDecorator('longitude', {
            rules: [
              {
                validator: validateLongitude
              }
            ],
            initialValue: longitude ? String(longitude) : ''
          })(
            <Input
              prefix={
                <Icon type="compass" style={{ color: 'rgba(0,0,0,.25)' }} />
              }
              type="text"
              placeholder="Longitude"
            />
          )}
        </CustomFormItem>
      </FormCol>

      <MakerEdit
        visible={showModal}
        handleCancel={handleCancel}
        getCurrentMaker={getCurrentMaker}
        editMaker={editMaker}
      />

      <MakerCreate
        visible={showModalCreate}
        handleCancel={handleCancelCreate}
        addMaker={addMaker}
      />
    </>
  )
}

===== END components/sculpture-maker-components/EditForm/EditFormTextFields.tsx =====


===== BEGIN components/sculpture-maker-components/EditForm/EditImage.tsx =====
'use client';

/**
 * Description: Image edit component for sculpture
 * Author: Hieu Chu
 */

import { Upload, Button, Icon, message, Row, Modal } from 'antd'
import { useState } from 'react'
import { ColStyled } from '../style'
import api from '../../../api'
import { useRouter } from 'next/navigation';

const { confirm } = Modal

const EditImage = ({ accessionId, _name, images }) => {
  const [fileList, setFileList] = useState([...images])
  const [isSubmitting, setIsSubmitting] = useState(false)

  const handleRemove = file => {
    return new Promise((resolve, _reject) => {
      confirm({
        title: 'Do you want to remove this image?',
        icon: <Icon type="exclamation-circle" style={{ color: '#ff4d4f' }} />,
        style: { top: 110 },
        maskClosable: true,
        okText: 'Confirm',
        okButtonProps: {
          style: {
            background: '#ff4d4f',
            borderColor: '#ff4d4f'
          }
        },
        onOk: async () => {
          setIsSubmitting(true)
          try {
            const _result = await api.delete(`/sculpture-images/${file.uid}`)
            resolve(true)
            setFileList(fileList => fileList.filter(x => x.uid !== file.uid))
            message.success('Deleted image successfully!', 2)
          } catch (error) {
            message.error(error.response.data.message)
            resolve(false)
          }
          setIsSubmitting(false)
        },
        onCancel: () => {
          resolve(false)
        }
      })
    })
  }

  const customRequest = async e => {
    const config = {
      headers: {
        'content-type':
          'multipart/form-data; boundary=----WebKitFormBoundaryqTqJIxvkWFYqvP5s'
      },
      onUploadProgress: function(progressEvent) {
        var percentCompleted = Math.round(
          (progressEvent.loaded * 100) / progressEvent.total
        )
        e.onProgress(percentCompleted)
      }
    }

    let data = new FormData()
    data.append('images', e.file)
    data.set('accessionId', accessionId)
    const hide = message.loading('Uploading image...', 0)
    setIsSubmitting(true)

    try {
      const _result = await api.post('/sculpture-images', data, config)
      const file = { ...e.file }
      const { id, url } = _result.data[0]
      file.uid = id
      file.url = url
      file.thumbUrl = url
      file.preview = url
      setFileList(fileList => [...fileList, file])

      e.onSuccess(_result.data[0], e.file)
      hide()
      message.success('Uploaded image successfully!', 2)
    } catch (error) {
      message.error(error.response.data.message)
      e.onError(error.response.data.message)
    }
    setIsSubmitting(false)
  }

  const uploadButton = (
    <div>
      <Icon type="plus" />
      <div className="ant-upload-text">Upload</div>
    </div>
  )

  return (
    <Row gutter={16}>
      <ColStyled xs={24}>
        <Upload
          accept="image/*"
          listType="picture-card"
          customRequest={customRequest}
          onRemove={handleRemove}
          fileList={fileList}
        >
          {uploadButton}
        </Upload>

        <Button
          type="primary"
          loading={isSubmitting}
          onClick={() =>
            router.push(`/sculptures/id/${accessionId}`)
          }
        >
          Finish
        </Button>
      </ColStyled>
    </Row>
  );
}

export default EditImage

===== END components/sculpture-maker-components/EditForm/EditImage.tsx =====


===== BEGIN components/sculpture-maker-components/EditForm/index.tsx =====
'use client';

/**
 * Description: Sculpture Edit Page component
 * Author: Hieu Chu
 */

import { CardStyled, ColStyled } from '../style'
import { Row, Modal, Button, Icon, message, notification } from 'antd'
import SculptureEdit from './SculptureEdit'
import { useRouter } from 'next/navigation';
import { useState, useEffect } from 'react'
import api from '../../../api'
import Loading from '../../Loading'
import Error from 'next/error'
import EditImage from './EditImage'
import Head from 'next/head'

const defaultPosition = [-34.40581053569814, 150.87842788963476]
const { confirm } = Modal

const tabList = [
  { key: 'tab1', tab: 'Edit text details' },
  { key: 'tab2', tab: 'Edit images' }
]

const SculptureEditForm = () => {
  const router = useRouter()
  const sculptureId = router.query.id

  const [initialData, setInitialData] = useState({})
  const [makerList, setMakerList] = useState([])
  const [tabKey, setTabKey] = useState('tab1')

  const handleTabChange = key => {
    setTabKey(key)
  }

  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  const handleDelete = () => {
    confirm({
      title: 'Do you want to remove this sculpture?',
      icon: <Icon type="exclamation-circle" style={{ color: '#ff4d4f' }} />,
      style: { top: 110 },
      maskClosable: true,
      okText: 'Confirm',
      okButtonProps: {
        style: {
          background: '#ff4d4f',
          borderColor: '#ff4d4f'
        }
      },
      onOk: async () => {
        const router = useRouter();
        try {
          const _result = await api.delete(`/sculpture/${sculptureId}`)
          message.success('Deleted sculpture successfully!', 2)
          router.push('/sculptures')
        } catch (error) {
          notification.error({
            message: 'Error',
            description: 'Internal server error.'
          })
        }
      }
    })
  }

  useEffect(() => {
    const fetchInitialForm = async () => {
      try {
        const data = (await api.get(`/sculpture/${sculptureId}`)).data
        if (data.latitude) {
          data.latitude = Number(data.latitude)
        }
        if (data.longitude) {
          data.longitude = Number(data.longitude)
        }
        console.log('init', data)
        setInitialData({ ...data })

        const makerData = (await api.get('/maker/')).data
        console.log('makers', makerData)
        setMakerList(makerData)
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }
    fetchInitialForm()
  }, [sculptureId])

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  initialData.images.sort(
    (a, b) => new Date(a.created).getTime() - new Date(b.created).getTime()
  )

  return (
    <>
      <Head>
        <title>Edit {initialData.name}- UOW Sculptures</title>
      </Head>
      <Row gutter={16}>
        <ColStyled xs={24}>
          <CardStyled
            title={`Edit details for ${initialData.name}`}
            tabList={tabList}
            activeTabKey={tabKey}
            onTabChange={handleTabChange}
            extra={
              <Button icon="delete" type="danger" onClick={handleDelete}>
                Delete
              </Button>
            }
          >
            <div style={{ display: tabKey === 'tab1' ? 'block' : 'none' }}>
              <SculptureEdit
                defaultPosition={defaultPosition}
                initialData={initialData}
                makerList={makerList}
                setMakerList={setMakerList}
              />
            </div>

            <div style={{ display: tabKey === 'tab2' ? 'block' : 'none' }}>
              <EditImage
                accessionId={initialData.accessionId}
                name={initialData.name}
                images={initialData.images.map(img => {
                  let formattedImg = { ...img }
                  formattedImg.uid = img.id
                  formattedImg.url = img.url
                  formattedImg.thumbUrl = img.url
                  formattedImg.preview = img.url
                  formattedImg.status = 'done'
                  return formattedImg
                })}
              />
            </div>
          </CardStyled>
        </ColStyled>
      </Row>
    </>
  )
}

export { SculptureEditForm }

===== END components/sculpture-maker-components/EditForm/index.tsx =====


===== BEGIN components/sculpture-maker-components/EditForm/MakerEdit.tsx =====
'use client'

/**
 * Description: Primary maker edit page component
 * Author: Hieu Chu
 */

import { useState } from 'react'
import { Input, Form, Button, Modal, message } from 'antd'
import { CustomFormItem } from '../style'
import api from '../../../api'

const MakerEdit = ({
  form: { getFieldDecorator, validateFields, resetFields },
  visible,
  handleCancel,
  getCurrentMaker,
  editMaker
}) => {
  const [submitting, setSubmitting] = useState(false)

  const {
    firstName,
    lastName,
    nationality,
    birthYear,
    deathYear,
    wikiUrl,
    id
  } = getCurrentMaker()

  const handleOk = e => {
    e.preventDefault()
    validateFields(async (err, values) => {
      if (!err) {
        console.log('Received values of maker form: ', values)
        for (let key in values) {
          if (!values[key]) {
            values[key] = null
          }
        }

        if (values.birthYear) {
          values.birthYear = Number(values.birthYear)
        }
        if (values.deathYear) {
          values.deathYear = Number(values.deathYear)
        }

        values.id = id
        console.log('after maker', values)

        setSubmitting(true)
        try {
          const _result = (await api.patch('/maker', values)).data
          setSubmitting(false)
          editMaker(values)
          handleCancel()
          resetFields()
          message.success('Updated maker details successfully!', 2)
        } catch (e) {
          setSubmitting(false)
          message.error(e.response.data.message)
        }
      }
    })
  }

  return (
    <Modal
      open={visible}
      title="Edit maker details"
      onOk={handleOk}
      onCancel={handleCancel}
      maskClosable={false}
      footer={[
        <Button key="back" onClick={() => resetFields()}>
          Reset
        </Button>,
        <Button
          key="submit"
          type="primary"
          loading={submitting}
          onClick={handleOk}
        >
          Submit
        </Button>
      ]}
    >
      <Form autoComplete="off">
        <CustomFormItem label="First name" hasFeedback>
          {getFieldDecorator('firstName', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the first name!'
              }
            ],
            initialValue: firstName
          })(<Input type="text" placeholder="First name" />)}
        </CustomFormItem>

        <CustomFormItem label="Last name" hasFeedback>
          {getFieldDecorator('lastName', {
            rules: [
              {
                required: true,
                whitespace: true,
                message: 'Please fill in the last name!'
              }
            ],
            initialValue: lastName
          })(<Input type="text" placeholder="Last name" />)}
        </CustomFormItem>

        <CustomFormItem label="Nationality" hasFeedback>
          {getFieldDecorator('nationality', {
            initialValue: nationality
          })(<Input type="text" placeholder="Nationality" />)}
        </CustomFormItem>

        <CustomFormItem label="Born" hasFeedback>
          {getFieldDecorator('birthYear', {
            rules: [
              {
                pattern: '^[0-9]{4}$',
                message: 'Please fill in a valid year!'
              }
            ],
            initialValue: birthYear ? String(birthYear) : ''
          })(<Input type="text" placeholder="Born" />)}
        </CustomFormItem>

        <CustomFormItem label="Passed away" hasFeedback>
          {getFieldDecorator('deathYear', {
            rules: [
              {
                pattern: '^[0-9]{4}$',
                message: 'Please fill in a valid year!'
              }
            ],
            initialValue: deathYear ? String(deathYear) : ''
          })(<Input type="text" placeholder="Passed away" />)}
        </CustomFormItem>

        <CustomFormItem label="Website" hasFeedback>
          {getFieldDecorator('wikiUrl', {
            rules: [
              {
                type: 'url',
                message: 'Please fill in a valid URL!'
              }
            ],
            initialValue: wikiUrl
          })(<Input type="text" placeholder="Website" />)}
        </CustomFormItem>
      </Form>
    </Modal>
  );
}

export default Form.create({
  name: 'maker_edit_form'
})(MakerEdit)

===== END components/sculpture-maker-components/EditForm/MakerEdit.tsx =====


===== BEGIN components/sculpture-maker-components/EditForm/SculptureEdit.tsx =====
'use client';

/**
 * Description: Sculpture edit page component
 * Author: Hieu Chu
 */

import { useState } from 'react'
import { Button, Form, message } from 'antd'
import { ColStyled, FormCol, CustomFormItem } from '../style'
import { FlyToInterpolator } from 'react-map-gl'
import Map from '../../map-components'
import EditFormTextFields from './EditFormTextFields'
import api from '../../../api'
import { useRouter } from 'next/navigation';

const SculptureEdit = ({
  form,
  form: { getFieldDecorator, setFieldsValue, getFieldValue, resetFields },
  defaultPosition,
  initialData,
  initialData: { latitude, longitude },
  makerList,
  setMakerList
}) => {
  const [view, setView] = useState({
    latitude: latitude ? latitude : defaultPosition[0],
    longitude: longitude ? longitude : defaultPosition[1],
    zoom: 15,
    pitch: 50
  })

  const [marker, setMarker] = useState({
    markerLat: latitude ? latitude : defaultPosition[0],
    markerLng: longitude ? longitude : defaultPosition[1]
  })

  const [submitting, setSubmitting] = useState(false)

  const flyTo = (latitude, longitude) => {
    setView({
      ...view,
      latitude,
      longitude,
      transitionInterpolator: new FlyToInterpolator(),
      transitionDuration: 1500,
      zoom: 15
    })

    setMarker({
      markerLat: latitude,
      markerLng: longitude
    })
  }

  const showLocationOnMap = () => {
    form.validateFields(['latitude', 'longitude'], (errors, values) => {
      if (!errors) {
        const { latitude, longitude } = values
        flyTo(+latitude, +longitude)
      }
    })
  }

  const handleSubmit = e => {
    e.preventDefault()
    form.validateFields(async (err, values) => {
      const router = useRouter();
      if (!err) {
        // remember to convert lat and long to numeric type
        console.log('Received values of form: ', values)
        for (let key in values) {
          if (!values[key]) {
            values[key] = null
          }
        }

        if (values.latitude) {
          values.latitude = Number(values.latitude)
        }

        if (values.longitude) {
          values.longitude = Number(values.longitude)
        }

        console.log('after', values)

        setSubmitting(true)
        try {
          const _result = (await api.patch('/sculpture', values)).data
          message.success('Updated sculpture details successfully!', 2)
          setSubmitting(false)
          router.push(`/sculptures/id/${values.accessionId}`)
        } catch (e) {
          setSubmitting(false)
          message.error(e.response.data.message)
        }
      }
    })
  }

  return (
    <Form onSubmit={handleSubmit} autoComplete="off">
      <ColStyled xs={24} md={12}>
        {/* long repeated list of text fields */}
        <EditFormTextFields
          getFieldDecorator={getFieldDecorator}
          setFieldsValue={setFieldsValue}
          getFieldValue={getFieldValue}
          initialData={initialData}
          makerList={makerList}
          setMakerList={setMakerList}
        />
        <FormCol xs={24}>
          <Button onClick={showLocationOnMap}>Show on map</Button>
        </FormCol>
      </ColStyled>

      <ColStyled
        xs={24}
        md={12}
        style={{
          height: 500,
          marginTop: 10
        }}
      >
        <Map
          view={view}
          marker={marker}
          setView={setView}
          setMarker={({ markerLat, markerLng }) => {
            setMarker({ markerLat, markerLng })
            setFieldsValue({
              latitude: String(markerLat),
              longitude: String(markerLng)
            })
          }}
        />
      </ColStyled>

      <ColStyled xs={24}>
        <FormCol xs={24}>
          <CustomFormItem style={{ marginBottom: 0, marginTop: 8 }}>
            <Button type="primary" htmlType="submit" loading={submitting}>
              Submit
            </Button>
            <Button
              type="default"
              style={{
                marginLeft: 5
              }}
              onClick={() => {
                resetFields()
                const flyLat = latitude ? latitude : defaultPosition[0]
                const flyLng = longitude ? longitude : defaultPosition[1]
                flyTo(flyLat, flyLng)
              }}
            >
              Reset
            </Button>
          </CustomFormItem>
        </FormCol>
      </ColStyled>
    </Form>
  )
}

export default Form.create({
  name: 'sculpture_edit_form'
})(SculptureEdit)

===== END components/sculpture-maker-components/EditForm/SculptureEdit.tsx =====


===== BEGIN components/sculpture-maker-components/MakerList.tsx =====
'use client'

/**
 * Description: Primary maker list component
 * Author: Hieu Chu
 */

import { useState, useEffect } from 'react'
import { Row, Divider, Modal, Icon, message, notification, Button } from 'antd'
import { ColStyled, CardStyled, StyledTable } from './style'
import MakerEdit from './EditForm/MakerEdit'
import api from '../../api'
import Loading from '../Loading'
import Error from 'next/error'
import MakerCreate from './CreateForm/MakerCreate'

const { confirm } = Modal

const MakerList = () => {
  useEffect(() => {
    const fetchMakerList = async () => {
      try {
        const data = (await api.get('/maker/')).data

        let formattedData = data.map(maker => {
          let formattedMaker = { ...maker }
          formattedMaker.key = maker.id
          return formattedMaker
        })

        formattedData.sort((a, b) => a.firstName.localeCompare(b.firstName))

        console.log(formattedData)
        setMakerList(formattedData)
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }
    fetchMakerList()
  }, [])

  const [makerList, setMakerList] = useState([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  const [showModal, setShowModal] = useState(false)
  const [showModalCreate, setShowModalCreate] = useState(false)

  const [currentMakerId, setCurrentMakerId] = useState('')
  const openModal = makerId => {
    setCurrentMakerId(makerId)
    setShowModal(true)
  }

  const openModalCreate = () => {
    setShowModalCreate(true)
  }

  const handleCancel = () => setShowModal(false)
  const handleCancelCreate = () => setShowModalCreate(false)

  const getCurrentMaker = () =>
    makerList.find(x => x.id === currentMakerId) || {}

  const editMaker = maker => {
    setMakerList(list =>
      list.map(x => {
        if (x.id === maker.id) {
          return { ...maker, key: maker.id }
        }
        return x
      })
    )
  }

  const deleteMaker = makerId => {
    setMakerList(list => list.filter(x => x.id !== makerId))
  }

  const addMaker = maker => {
    maker.key = maker.id
    setMakerList(list => [...list, maker])
  }

  const handleDelete = makerId => {
    confirm({
      title: 'Do you want to remove this maker?',
      icon: <Icon type="exclamation-circle" style={{ color: '#ff4d4f' }} />,
      style: { top: 110 },
      maskClosable: true,
      okText: 'Confirm',
      okButtonProps: {
        style: {
          background: '#ff4d4f',
          borderColor: '#ff4d4f'
        }
      },
      onOk: async () => {
        try {
          const _result = await api.delete(`/maker/${makerId}`)
          deleteMaker(makerId)
          message.success('Deleted maker successfully!', 2)
        } catch (error) {
          notification.error({
            message: 'Error',
            description:
              'There has been internal server error or the maker you\'re trying to delete is currently associated with a sculpture.'
          })
        }
      }
    })
  }

  const columns = [
    {
      title: 'Maker name',
      key: 'makerName',
      width: '22%',
      render: (_, record) => {
        const { firstName, lastName, wikiUrl } = record
        const makerName = firstName + ' ' + lastName
        if (!wikiUrl) {
          return <span>{makerName}</span>
        }
        return <a href={wikiUrl}>{makerName}</a>
      }
    },

    {
      title: 'Nationality',
      dataIndex: 'nationality',
      width: '22%'
    },
    {
      title: 'Born - Passed away',
      key: 'year',
      width: '28%',
      render: (_, record) => {
        let { birthYear, deathYear } = record
        if (!birthYear) birthYear = 'N/A'
        if (!deathYear) deathYear = 'N/A'
        return <span>{birthYear + ' - ' + deathYear}</span>
      }
    },
    {
      title: 'Action',
      key: 'action',
      render: record => (
        <span>
          <a onClick={() => openModal(record.key)}>Edit</a>
          <Divider type="vertical" />
          <a onClick={() => handleDelete(record.key)}>Delete</a>
        </span>
      )
    }
  ]

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  return (
    <Row gutter={16}>
      <ColStyled xs={24}>
        <CardStyled
          title="Maker List"
          extra={
            <Button type="primary" icon="plus" onClick={openModalCreate}>
              Add new maker
            </Button>
          }
        >
          <StyledTable
            dataSource={makerList}
            columns={columns}
            pagination={{ pageSize: 25, hideOnSinglePage: true }}
            style={{ maxWidth: 750 }}
          />
        </CardStyled>
      </ColStyled>

      <MakerEdit
        visible={showModal}
        handleCancel={handleCancel}
        getCurrentMaker={getCurrentMaker}
        editMaker={editMaker}
      />

      <MakerCreate
        visible={showModalCreate}
        handleCancel={handleCancelCreate}
        addMaker={addMaker}
      />
    </Row>
  )
}

export default MakerList

===== END components/sculpture-maker-components/MakerList.tsx =====


===== BEGIN components/sculpture-maker-components/SculptureDetail/index.tsx =====
'use client'

/**
 * Description: Sculpture Detail page component
 * Author: Hieu Chu
 */

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { Row, Carousel, Typography, List, Empty, Button } from 'antd'
import { ColStyled, CardStyled } from '../style'
import { SculptureCardDescription } from '../SculptureGrid'
import api from '../../../api'
import Loading from '../../Loading'
import Error from 'next/error'
import MyStaticMap from '../../map-components/StaticMap'
import Link from 'next/link'
import Head from 'next/head'
import SculptureComment from './SculptureComment'
import SculptureTrend from './SculptureTrend'

const { Title } = Typography

const SculptureDetail = () => {
  const [sculpture, setSculpture] = useState({})
  const [comments, setComments] = useState([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  useEffect(() => {
    const fetchData = async () => {
      try {
        const sculpturePromise = api.get(`/sculpture/${id}`)
        const commentPromise = api.get(`/comment/sculpture-id/${id}`)

        const [rawSculpture, rawComments] = await Promise.all([
          sculpturePromise,
          commentPromise
        ])

        setComments(rawComments.data)
        console.log('hhhh', rawComments.data)
        setSculpture(rawSculpture.data)
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }

    fetchData()
  }, [id])

  const deleteComment = commentId => {
    setComments(c => c.filter(x => x.commentId !== commentId))
    setSculpture(x => ({
      ...x,
      totalComments: +x.totalComments - 1
    }))
  }

  const addComment = comment => {
    setComments(c => [comment, ...c])
    setSculpture(x => ({
      ...x,
      totalComments: +x.totalComments + 1
    }))
  }

  const router = useRouter()
  const id = router.query.id

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  const {
    images,
    name,
    primaryMaker,
    accessionId,
    longitude,
    latitude,
    productionDate,
    material,
    creditLine,
    locationNotes,
    totalLikes,
    totalComments,
    totalVisits
  } = sculpture

  const { birthYear, deathYear, nationality, wikiUrl } = primaryMaker

  const markerLat = Number(latitude)
  const markerLng = Number(longitude)

  images.sort(
    (a, b) => new Date(a.created).getTime() - new Date(b.created).getTime()
  )
  const imageList = images.map((image, idx) => (
    <div key={idx}>
      <img src={image.url} />
    </div>
  ))

  return (
    <>
      <Head>
        <title>{name} - UOW Sculptures</title>
      </Head>
      <Row gutter={16}>
        <ColStyled xs={24} lg={15}>
          <CardStyled
            title="Sculpture Details"
            extra={
              <Link href={`/sculptures/id/${id}/edit`}>
                <a>
                  <Button icon="edit">Edit details</Button>
                </a>
              </Link>
            }
          >
            <Carousel
              draggable
              style={{
                width: '100%'
              }}
            >
              {images.length ? (
                imageList
              ) : (
                <div>
                  <Empty
                    image={Empty.PRESENTED_IMAGE_SIMPLE}
                    style={{ height: 100, marginTop: 100 }}
                  />
                </div>
              )}
            </Carousel>
            <div
              style={{
                marginTop: 15
              }}
            >
              <Title level={4} style={{ marginBottom: 0 }}>
                {name}
              </Title>
              <SculptureCardDescription
                totalLikes={totalLikes}
                totalComments={totalComments}
                totalVisits={totalVisits}
                makerName={primaryMaker.firstName + ' ' + primaryMaker.lastName}
              />

              <List itemLayout="horizontal">
                <List.Item>
                  <List.Item.Meta
                    title="Accession ID"
                    description={
                      !accessionId.includes('unknown') ? accessionId : 'N/A'
                    }
                  />
                </List.Item>
                <List.Item>
                  <List.Item.Meta
                    title="Production Date"
                    description={productionDate ? productionDate : 'N/A'}
                  />
                </List.Item>
                <List.Item>
                  <List.Item.Meta
                    title="Material"
                    description={material ? material : 'N/A'}
                  />
                </List.Item>
                <List.Item>
                  <List.Item.Meta
                    title="Credit Line"
                    description={
                      creditLine
                        ? creditLine
                            .trim()
                            .split('\n')
                            .map((line, idx) => <div key={idx}>{line}</div>)
                        : 'N/A'
                    }
                  />
                </List.Item>
                <List.Item>
                  <List.Item.Meta
                    title="Location Details"
                    description={
                      locationNotes
                        ? locationNotes
                            .trim()
                            .split('\n')
                            .map((line, idx) => <div key={idx}>{line}</div>)
                        : 'N/A'
                    }
                  />
                </List.Item>
              </List>
            </div>
          </CardStyled>

          <SculptureTrend
            totalLikes={totalLikes}
            totalComments={totalComments}
            totalVisits={totalVisits}
            sculptureId={id}
          />
        </ColStyled>
        {/* Maker detail */}
        <ColStyled xs={24} lg={9}>
          <MyStaticMap markerLat={markerLat} markerLng={markerLng} />
          <CardStyled title="Primary maker details" style={{ marginTop: 10 }}>
            <List
              itemLayout="horizontal"
              style={{
                marginTop: -20
              }}
            >
              <List.Item>
                <List.Item.Meta
                  title="Full Name"
                  description={
                    primaryMaker.firstName + ' ' + primaryMaker.lastName
                  }
                />
              </List.Item>
              <List.Item>
                <List.Item.Meta
                  title="Nationality"
                  description={nationality ? nationality : 'N/A'}
                />
              </List.Item>
              <List.Item>
                <List.Item.Meta
                  title="Born"
                  description={birthYear ? birthYear : 'N/A'}
                />
              </List.Item>
              <List.Item>
                <List.Item.Meta
                  title="Passed away"
                  description={deathYear ? deathYear : 'N/A'}
                />
              </List.Item>
              <List.Item>
                <List.Item.Meta
                  title="Website"
                  description={
                    wikiUrl ? <a href={`${wikiUrl}`}>{wikiUrl}</a> : 'N/A'
                  }
                />
              </List.Item>
            </List>
          </CardStyled>

          <SculptureComment
            comments={comments}
            deleteComment={deleteComment}
            addComment={addComment}
            sculptureId={id}
          />
        </ColStyled>
      </Row>
    </>
  );
}

export default SculptureDetail

===== END components/sculpture-maker-components/SculptureDetail/index.tsx =====


===== BEGIN components/sculpture-maker-components/SculptureDetail/SculptureComment.tsx =====
'use client'

/**
 * Description: Sculpture's comment list component
 * Author: Hieu Chu
 */

import moment from 'moment'
import {
  Tooltip,
  List,
  Comment,
  Card,
  Icon,
  Dropdown,
  Menu,
  Modal,
  message,
  Button,
  Empty
} from 'antd'
import Link from 'next/link'
import api from '../../../api'
import { useState } from 'react'
import TextArea from 'antd/lib/input/TextArea'
const { confirm } = Modal

const SculptureComment = ({
  comments,
  deleteComment,
  addComment,
  sculptureId
}) => {
  comments.sort(
    (a, b) =>
      new Date(b.createdTime).getTime() - new Date(a.createdTime).getTime()
  )

  const handleDelete = e => {
    console.log(e.key)
    confirm({
      title: 'Delete this comment permanently?',
      icon: <Icon type="exclamation-circle" style={{ color: '#ff4d4f' }} />,
      style: { top: 110 },
      maskClosable: true,
      okText: 'Confirm',
      okButtonProps: {
        style: {
          background: '#ff4d4f',
          borderColor: '#ff4d4f'
        }
      },
      onOk: async () => {
        try {
          const _result = await api.delete(`/comment/${e.key}`)
          message.success('Deleted comment successfully!', 2)
          deleteComment(e.key)
        } catch (error) {
          message.error(error.response.data.message)
        }
      }
    })
  }

  const [submitting, setSubmitting] = useState(false)
  const [value, setValue] = useState('')

  const getMenu = commentId => (
    <Menu onClick={handleDelete}>
      <Menu.Item key={commentId}>Delete comment</Menu.Item>
    </Menu>
  )

  const formattedComments = comments.map(x => ({
    commentId: x.commentId,
    author: (
      <Link href={`/users/id/${x.user.userId}`}>
        <a
          style={{
            fontSize: 14,
            fontWeight: 500,
            color: 'rgba(0, 0, 0, 0.65)'
          }}
        >
          {x.user.userId.includes('auth0') ? x.user.nickname : x.user.name}
        </a>
      </Link>
    ),
    avatar: (
      <img
        src={x.user.picture}
        style={{
          width: 42,
          height: 42,
          borderRadius: '50%',
          objectFit: 'cover'
        }}
      />
    ),
    content: (
      <div
        style={{
          fontSize: 14
        }}
      >
        {x.content
          .trim()
          .split('\n')
          .map((line, idx) => (
            <div key={idx}>{line}</div>
          ))}
      </div>
    ),
    datetime: (
      <div
        style={{
          display: 'flex'
        }}
      >
        <Tooltip title={moment(x.createdTime).format('D MMMM YYYY, h:mm:ss a')}>
          <div
            style={{
              fontSize: 14,
              color: 'rgba(0, 0, 0, 0.35)'
            }}
          >
            {moment(x.createdTime).fromNow()}
          </div>
        </Tooltip>
        <div
          style={{
            fontSize: 14,
            color: 'rgba(0, 0, 0, 0.45)',
            marginLeft: 'auto'
          }}
        >
          <Dropdown overlay={getMenu(x.commentId)} trigger={['click']}>
            <Icon type="more" />
          </Dropdown>
        </div>
      </div>
    )
  }))

  return (
    <Card
      title="Comments"
      bodyStyle={{ padding: '20px 24px 0px' }}
      bordered={false}
      style={{ marginTop: 12 }}
    >
      <List
        itemLayout="horizontal"
        dataSource={formattedComments}
        className="comment-list"
        locale={{
          emptyText: (
            <Empty
              image={Empty.PRESENTED_IMAGE_SIMPLE}
              description="No Comments"
            />
          )
        }}
        renderItem={item => (
          <li>
            <Comment
              author={item.author}
              avatar={item.avatar}
              content={item.content}
              datetime={item.datetime}
              className="comment"
            />
          </li>
        )}
        pagination={{ pageSize: 15, hideOnSinglePage: true }}
      />
      <Comment
        className="admin-comment"
        avatar={
          <img
            src={'../../../static/avatar.png'}
            style={{
              width: 42,
              height: 42,
              borderRadius: '50%',
              objectFit: 'cover'
            }}
          />
        }
        content={
          <Editor
            value={value}
            setValue={setValue}
            submitting={submitting}
            setSubmitting={setSubmitting}
            sculptureId={sculptureId}
            addComment={addComment}
          />
        }
      />
    </Card>
  )
}

const Editor = ({
  value,
  setValue,
  setSubmitting,
  submitting,
  sculptureId,
  addComment
}) => (
  <>
    <div style={{ marginBottom: 12 }}>
      <TextArea
        autosize={{ minRows: 2 }}
        onChange={e => {
          setValue(e.target.value)
        }}
        value={value}
      />
    </div>
    <div style={{ marginBottom: 16 }}>
      <Button
        htmlType="submit"
        disabled={value.trim() === ''}
        loading={submitting}
        onClick={async () => {
          setSubmitting(true)
          try {
            const result = (await api.post('/comment', {
              sculptureId,
              content: value
            })).data
            setSubmitting(false)
            setValue('')
            console.log(result)
            addComment(result)
          } catch (e) {
            setSubmitting(false)
            message.error(e.response.data.message)
          }
        }}
        type="primary"
      >
        Post
      </Button>
    </div>
  </>
)

export default SculptureComment

===== END components/sculpture-maker-components/SculptureDetail/SculptureComment.tsx =====


===== BEGIN components/sculpture-maker-components/SculptureDetail/SculptureTrend.tsx =====
'use client'

/**
 * Description: Sculpture's trends graph component
 * Author: Hieu Chu
 */

import 'ant-design-pro/lib/Charts/style/index.less'
import {
  ColStyled,
  VisitCard,
  LikeCard,
  CommentCard
} from '../../dashboard-components/'
import { Dropdown, Icon, Menu, DatePicker } from 'antd'

const { RangePicker } = DatePicker

import moment from 'moment'
import { useState, useEffect, useRef } from 'react'
import Loading from '../../Loading'
import Error from 'next/error'
import api from '../../../api'
import { CardStyled, ShadowCard } from '../../dashboard-components/style'

const formatDailyData = rawData => {
  const result = []
  for (let date of Object.keys(rawData)) {
    result.push({
      x: moment(date).format('MMM D YYYY'),
      y: rawData[date]
    })
  }
  // sort in correct order
  result.sort((a, b) => moment(a.x).valueOf() - moment(b.x).valueOf)

  return result
}

const SculptureTrend = ({
  totalLikes,
  totalComments,
  totalVisits,
  sculptureId
}) => {
  const [state, setState] = useState({})
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  const defaultEndDate = useRef(moment(new Date())).current
  const defaultStartDate = useRef(moment(defaultEndDate).subtract(7, 'days'))
    .current

  const [startDate, setStartDate] = useState(defaultStartDate)
  const [endDate, setEndDate] = useState(defaultEndDate)

  useEffect(() => {
    const fetchData = async () => {
      try {
        const past = startDate.format('YYYY-MM-DD')
        const today = endDate.format('YYYY-MM-DD')
        const defaultToday = defaultEndDate.format('YYYY-MM-DD')

        const likesPromise = api.get(
          `/stats/likes/sculpture-id/${sculptureId}?fromDate=${past}&toDate=${today}`
        )
        const commentsPromise = api.get(
          `/stats/comments/sculpture-id/${sculptureId}?fromDate=${past}&toDate=${today}`
        )
        const visitPromise = api.get(
          `/stats/visits/sculpture-id/${sculptureId}?fromDate=${past}&toDate=${today}`
        )

        const defaultLikesPromise = api.get(
          `/stats/likes/sculpture-id/${sculptureId}?fromDate=${past}&toDate=${defaultToday}`
        )
        const defaultCommentsPromise = api.get(
          `/stats/comments/sculpture-id/${sculptureId}?fromDate=${past}&toDate=${defaultToday}`
        )
        const defaultVisitsPromise = api.get(
          `/stats/visits/sculpture-id/${sculptureId}?fromDate=${past}&toDate=${defaultToday}`
        )

        const [
          { data: rawLikes },
          { data: rawComments },
          { data: rawVisits },
          { data: rawDefaultLikes },
          { data: rawDefaultComments },
          { data: rawDefaultVisits }
        ] = await Promise.all([
          likesPromise,
          commentsPromise,
          visitPromise,
          defaultLikesPromise,
          defaultCommentsPromise,
          defaultVisitsPromise
        ])

        // format daily data statistics
        const LIKE_DATA = formatDailyData(rawLikes)
        const COMMENT_DATA = formatDailyData(rawComments)
        const VISIT_DATA = formatDailyData(rawVisits)

        const DEFAULT_LIKE_DATA = formatDailyData(rawDefaultLikes)
        const DEFAULT_COMMENT_DATA = formatDailyData(rawDefaultComments)
        const DEFAULT_VISIT_DATA = formatDailyData(rawDefaultVisits)

        const DAILY_VISITS = DEFAULT_VISIT_DATA[DEFAULT_VISIT_DATA.length - 1].y
        const DAILY_VISITS_CHANGE =
          DAILY_VISITS - DEFAULT_VISIT_DATA[DEFAULT_VISIT_DATA.length - 2].y

        const DAILY_LIKES = DEFAULT_LIKE_DATA[DEFAULT_LIKE_DATA.length - 1].y
        const DAILY_LIKES_CHANGE =
          DAILY_LIKES - DEFAULT_LIKE_DATA[DEFAULT_LIKE_DATA.length - 2].y

        const DAILY_COMMENTS =
          DEFAULT_COMMENT_DATA[DEFAULT_COMMENT_DATA.length - 1].y
        const DAILY_COMMENTS_CHANGE =
          DAILY_COMMENTS -
          DEFAULT_COMMENT_DATA[DEFAULT_COMMENT_DATA.length - 2].y
        console.log(DEFAULT_COMMENT_DATA)
        console.log('c:', DAILY_COMMENTS)
        console.log('change:', DAILY_COMMENTS_CHANGE)

        setState(state => ({
          ...state,
          TOTAL_VISITS: totalVisits,
          DAILY_VISITS,
          DAILY_VISITS_CHANGE,
          TOTAL_LIKES: totalLikes,
          DAILY_LIKES,
          DAILY_LIKES_CHANGE,
          TOTAL_COMMENTS: totalComments,
          DAILY_COMMENTS,
          DAILY_COMMENTS_CHANGE,
          VISIT_DATA,
          LIKE_DATA,
          COMMENT_DATA
        }))
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }
    fetchData()
  }, [
    defaultEndDate,
    endDate,
    sculptureId,
    startDate,
    totalComments,
    totalLikes,
    totalVisits
  ])

  const dateFormat = 'MMM D YYYY'
  const staticToday = moment(new Date())

  const generateMenu = (startDate, endDate) => {
    const disabledDate = current => {
      return current.valueOf() > staticToday.valueOf()
    }

    return (
      <Menu className="date-menu">
        <RangePicker
          defaultValue={[startDate, endDate]}
          value={[startDate, endDate]}
          format={dateFormat}
          size="large"
          allowClear={false}
          separator="-"
          disabledDate={disabledDate}
          ranges={{
            'Past week': [
              moment(staticToday).subtract(7, 'days'),
              moment(staticToday)
            ],
            'Past 2 weeks': [
              moment(staticToday).subtract(14, 'days'),
              moment(staticToday)
            ],
            'Past month': [
              moment(staticToday).subtract(30, 'days'),
              moment(staticToday)
            ]
          }}
          onChange={date => {
            console.log(date)
            if (date[0].valueOf() !== date[1].valueOf()) {
              console.log('not the same')
              setStartDate(date[0])
              setEndDate(date[1])
            } else {
              console.log('the same')
            }
          }}
        />
      </Menu>
    )
  }

  const {
    TOTAL_VISITS,
    DAILY_VISITS,
    DAILY_VISITS_CHANGE,
    TOTAL_LIKES,
    DAILY_LIKES,
    DAILY_LIKES_CHANGE,
    TOTAL_COMMENTS,
    DAILY_COMMENTS,
    DAILY_COMMENTS_CHANGE,
    VISIT_DATA,
    LIKE_DATA,
    COMMENT_DATA
  } = state

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  return (
    <CardStyled
      title="Trends"
      extra={
        <Dropdown
          overlay={generateMenu(startDate, endDate)}
          trigger={['click']}
          placement="bottomRight"
        >
          <Icon type="more" />
        </Dropdown>
      }
      type="stats"
      style={{ marginTop: 12 }}
    >
      <ColStyled xs={24}>
        <ShadowCard>
          <LikeCard
            TOTAL_LIKES={TOTAL_LIKES}
            DAILY_LIKES={DAILY_LIKES}
            DAILY_LIKES_CHANGE={DAILY_LIKES_CHANGE}
            LIKE_DATA={LIKE_DATA}
            startDate={startDate}
            endDate={endDate}
          />
        </ShadowCard>
      </ColStyled>

      <ColStyled xs={24}>
        <ShadowCard>
          <CommentCard
            TOTAL_COMMENTS={TOTAL_COMMENTS}
            DAILY_COMMENTS={DAILY_COMMENTS}
            DAILY_COMMENTS_CHANGE={DAILY_COMMENTS_CHANGE}
            COMMENT_DATA={COMMENT_DATA}
            startDate={startDate}
            endDate={endDate}
          />
        </ShadowCard>
      </ColStyled>

      <ColStyled xs={24}>
        <ShadowCard>
          <VisitCard
            TOTAL_VISITS={TOTAL_VISITS}
            DAILY_VISITS={DAILY_VISITS}
            DAILY_VISITS_CHANGE={DAILY_VISITS_CHANGE}
            VISIT_DATA={VISIT_DATA}
            startDate={startDate}
            endDate={endDate}
            SINGLE_SCULPTURE
          />
        </ShadowCard>
      </ColStyled>
    </CardStyled>
  )
}

export default SculptureTrend

===== END components/sculpture-maker-components/SculptureDetail/SculptureTrend.tsx =====


===== BEGIN components/sculpture-maker-components/SculptureGrid.tsx =====
'use client'

/**
 * Description: Sculpture list component
 * Author: Hieu Chu
 */

import { useState, useEffect } from 'react'
import {
  Row,
  Card,
  Typography,
  Tooltip,
  Input,
  Empty,
  Button,
  Dropdown,
  Icon,
  Menu
} from 'antd'
const { Text } = Typography
const { Meta } = Card
const { Search } = Input
import Link from 'next/link'
import {
  ColStyled,
  CardStyled,
  DescriptionIcon,
  ShadowCard,
  Subtitle,
  EmptyImage
} from './style'
import Loading from '../Loading'
import Error from 'next/error'
import api from '../../api'

const SculptureCard = ({
  info: {
    accessionId,
    name,
    totalVisits,
    totalLikes,
    totalComments,
    primaryMaker,
    images
  }
}) => {
  const makerName = primaryMaker.firstName + ' ' + primaryMaker.lastName
  images.sort(
    (a, b) => new Date(a.created).getTime() - new Date(b.created).getTime()
  )
  return (
    <Link href={`/sculptures/id/${accessionId}`}>
      <a style={{ display: 'inline-block', width: '100%' }}>
        <ShadowCard
          cover={
            images.length ? (
              <div style={{ height: 450 }}>
                <img
                  src={images[0].url}
                  style={{
                    height: '100%',
                    width: '100%',
                    objectFit: 'cover'
                  }}
                />
              </div>
            ) : (
              (<EmptyImage
                image={Empty.PRESENTED_IMAGE_SIMPLE}
                description="No Images"
              />)
              // <div style={{ height: 450, border: '1px solid black' }}>hey</div>
            )
          }
          bordered={true}
        >
          <Meta
            title={name}
            description={
              <SculptureCardDescription
                totalLikes={totalLikes}
                totalComments={totalComments}
                totalVisits={totalVisits}
                makerName={makerName}
              />
            }
          />
        </ShadowCard>
      </a>
    </Link>
  );
}

export const SculptureCardDescription = ({
  totalLikes,
  totalComments,
  totalVisits,
  makerName
}) => {
  return (
    <>
      <Subtitle type="secondary">{makerName}</Subtitle>
      <Tooltip placement="top" title="Likes">
        <DescriptionIcon
          type="heart"
          theme="twoTone"
          twoToneColor="#eb2f96"
          style={{ marginRight: 4 }}
        />
        <Text type="secondary" style={{ marginRight: 8 }}>
          {totalLikes}
        </Text>
      </Tooltip>

      <Tooltip placement="top" title="Comments">
        <DescriptionIcon
          type="message"
          theme="twoTone"
          twoToneColor="rgb(205, 34, 255)"
          style={{ marginRight: 4 }}
        />
        <Text type="secondary" style={{ marginRight: 5 }}>
          {totalComments}
        </Text>
      </Tooltip>

      <Tooltip placement="top" title="Visits">
        <DescriptionIcon
          type="environment"
          style={{ color: '#F73F3F', marginRight: 3 }}
        />
        <Text type="secondary" style={{ marginRight: 4 }}>
          {totalVisits}
        </Text>
      </Tooltip>
    </>
  )
}

// custom sort function
const sortBy = (list, criterion) => {
  switch (criterion) {
    case 'Likes':
      return list.slice().sort((a, b) => +b.totalLikes - +a.totalLikes)
    case 'Comments':
      return list.slice().sort((a, b) => +b.totalComments - +a.totalComments)
    case 'Visits':
      return list.slice().sort((a, b) => +b.totalVisits - +a.totalVisits)
    case 'Default':
      return list.slice().sort((a, b) => a.name.localeCompare(b.name))
  }
}

const SculptureGrid = () => {
  const [originalList, setOriginalList] = useState([])
  const [filteredList, setFilteredList] = useState(originalList.slice())
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  const [currentSort, setSort] = useState('Default')

  useEffect(() => {
    const fetchSculpture = async () => {
      try {
        let { data } = await api.get('/sculpture')
        data.sort((a, b) => a.name.localeCompare(b.name))
        console.log(data)
        setOriginalList(data)
        setFilteredList(data)
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }

    fetchSculpture()
  }, [])

  // Menu handler
  function handleMenuClick(e) {
    // console.log('click', e.key)
    setSort(e.key)
    setFilteredList(filteredList => sortBy(filteredList, e.key))
  }

  // Menu list UI overlay
  const menu = (
    <Menu onClick={handleMenuClick}>
      <Menu.Item key="Default">Default</Menu.Item>
      <Menu.Item key="Likes">Likes</Menu.Item>
      <Menu.Item key="Comments">Comments</Menu.Item>
      <Menu.Item key="Visits">Visits</Menu.Item>
    </Menu>
  )

  const handleChange = e => {
    const input = e.target.value
    if (input.length >= 3) {
      let newList = originalList.filter(sculpture => {
        let makerName =
          sculpture.primaryMaker.firstName +
          ' ' +
          sculpture.primaryMaker.lastName

        return (
          sculpture.name.toLowerCase().includes(input.toLowerCase()) ||
          makerName.toLowerCase().includes(input.toLowerCase())
        )
      })
      setFilteredList(sortBy(newList, currentSort))
    } else {
      if (filteredList.length !== originalList.length) {
        setFilteredList(sortBy(originalList.slice(), currentSort))
      }
    }
  }

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  return (
    <Row gutter={16}>
      <ColStyled xs={24}>
        <CardStyled
          title="Sculpture Collection"
          extra={
            <Link href="/sculptures/create">
              <a>
                <Button type="primary" icon="plus">
                  Add new sculpture
                </Button>
              </a>
            </Link>
          }
        >
          <div
            style={{
              marginLeft: 8,
              marginRight: 8,
              marginBottom: 16,
              display: 'flex'
            }}
          >
            <Search
              allowClear
              placeholder="Enter search term"
              onChange={handleChange}
              size="large"
              style={{
                marginRight: 8
              }}
            />

            <Dropdown overlay={menu} trigger={['click']}>
              <Button size="large">
                <Icon type="sort-ascending" /> {currentSort}{' '}
                <Icon type="down" />
              </Button>
            </Dropdown>
          </div>

          <>
            {!filteredList.length ? (
              <Empty
                image={Empty.PRESENTED_IMAGE_SIMPLE}
                description="No Data :("
                style={{ marginTop: 60 }}
              />
            ) : (
              filteredList.map(sculpture => {
                return (
                  <ColStyled xs={24} sm={12} md={8} key={sculpture.accessionId}>
                    <SculptureCard info={sculpture} />
                  </ColStyled>
                )
              })
            )}
          </>
        </CardStyled>
      </ColStyled>
    </Row>
  )
}

export default SculptureGrid

===== END components/sculpture-maker-components/SculptureGrid.tsx =====


===== BEGIN components/sculpture-maker-components/style.tsx =====
/**
 * Description: Stylesheet for sculpture-maker components
 * Author: Hieu Chu
 */

import styled from 'styled-components'
import { Card, Col, Icon, Form, Typography, Empty, Table } from 'antd'

const { Text } = Typography

export const CardStyled = props => (
  <Card bodyStyle={{ padding: '20px 24px 20px' }} bordered={false} {...props} />
)

export const ColStyled = styled(Col)`
  padding-bottom: 12px;
`

export const DescriptionIcon = styled(Icon)`
  font-size: 20px;
`

export const ShadowCard = styled(CardStyled)`
  box-shadow: rgba(0, 0, 0, 0.06) 0px 9px 24px;
  border-width: 1px;
  border-style: solid;
  border-color: rgb(242, 242, 242);
  border-radius: 3px;
  transition: all 150ms ease-in-out 0s;

  &:hover {
    box-shadow: rgba(0, 0, 0, 0.1) 0px 9px 24px;
    cursor: pointer;
    transition: all 150ms ease-in-out 0s;
  }
`

export const CustomFormItem = styled(Form.Item)`
  margin-bottom: 8px;

  &.ant-form-item-with-help {
    margin-bottom: 5px;
  }
`

export const FormCol = styled(Col)`
  padding-left: 0px !important;
  padding-right: 0px !important;
`

export const Subtitle = styled(Text)`
  display: block;
  margin-bottom: 12px;
`

export const EmptyImage = styled(Empty)`
  height: 230px;
  margin: 0;
  border-bottom: 0.3px solid rgba(0, 0, 0, 0.25);

  & .ant-empty-image {
    margin-top: 220px;
  }
`

export const StyledTable = styled(Table)`
  .ant-table table {
    border-left: 1px solid #e8e8e8;
    border-top: 1px solid #e8e8e8;
    border-right: 1px solid #e8e8e8;
  }
`

===== END components/sculpture-maker-components/style.tsx =====


===== BEGIN components/shared/utils.tsx =====
/**
 * Description: Shared utility functions
 * Author: Hieu Chu
 */

export const validateLatitude = (rule, value, callback) => {
  if (!value || !value.trim()) return callback()
  if (isNaN(value)) {
    return callback('Please fill in a valid latitude value!')
  } else {
    if (parseFloat(value) <= -90 || parseFloat(value) >= 90) {
      return callback('Please fill in a valid latitude value!')
    }
  }
  return callback()
}

export const validateLongitude = (rule, value, callback) => {
  if (!value || !value.trim()) return callback()
  if (isNaN(value)) {
    return callback('Please fill in a valid longitude value!')
  } else {
    if (parseFloat(value) <= -180 || parseFloat(value) >= 180) {
      return callback('Please fill in a valid longitude value!')
    }
  }
  return callback()
}

export const convertNonAccent = str => {
  str = str.toLowerCase()
  str = str.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g, 'a')
  str = str.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g, 'e')
  str = str.replace(/ì|í|ị|ỉ|ĩ/g, 'i')
  str = str.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g, 'o')
  str = str.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g, 'u')
  str = str.replace(/ỳ|ý|ỵ|ỷ|ỹ/g, 'y')
  str = str.replace(/đ/g, 'd')
  str = str.replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g, '')
  str = str.replace(/\u02C6|\u0306|\u031B/g, '')
  return str
}

===== END components/shared/utils.tsx =====


===== BEGIN components/TagsList.tsx =====
// frontend/components/TagsList.tsx
'use client' 
import React from "react";
import { useExpertiseTags } from "../hooks/useExpertiseTags";

export default function TagsList() {
  const { data, isLoading, error } = useExpertiseTags();

  if (isLoading) return <p>Loading…</p>;
  if (error)     return <p>Error loading tags</p>;

  return (
    <ul>
      {data.map((tag: { id: number; name: string }) => (
        <li key={tag.id}>{tag.name}</li>
      ))}
    </ul>
  );
}

===== END components/TagsList.tsx =====


===== BEGIN components/ThemeSwitcher.tsx =====
import React from 'react';
import { Button } from 'antd';
import { useTheme } from '@/context/ThemeContext';

const ThemeSwitcher: React.FC = () => {
  const { token, cycleTheme } = useTheme();   // token contient label + icon

  return (
    <Button onClick={cycleTheme}>
      {token.icon ? `${token.icon} ` : ''}{token.label ?? 'Theme'}
    </Button>
  );
};

export default ThemeSwitcher;

===== END components/ThemeSwitcher.tsx =====


===== BEGIN components/Tooltip/Tooltip.tsx =====
"use client"

import * as RadixTooltip from "@radix-ui/react-tooltip"
import { cva, type VariantProps } from "class-variance-authority"
import React from "react"
import { twMerge } from "tailwind-merge"

const tooltipContent = cva([], {
  variants: {
    intent: {
      primary: ["rounded-md", "bg-zinc-700", "font-sans", "text-white"],
    },
    size: {
      md: ["px-4", "py-2.5", "text-xs"],
    },
  },
  defaultVariants: {
    intent: "primary",
    size: "md",
  },
})

const tooltipArrow = cva([], {
  variants: {
    intent: {
      primary: ["fill-zinc-700"],
    },
    size: {
      md: ["w-4", "h-2"],
    },
  },
  defaultVariants: {
    intent: "primary",
    size: "md",
  },
})

export interface TooltipProps extends VariantProps<typeof tooltipContent>, RadixTooltip.TooltipProps {
  explainer: React.ReactElement | string
  children: React.ReactElement
  className?: string
  withArrow?: boolean
  side?: "top" | "right" | "bottom" | "left"
}

export function Tooltip({
  children,
  explainer,
  open,
  defaultOpen,
  onOpenChange,
  intent,
  size,
  side = "top",
  className,
  withArrow,
}: TooltipProps) {
  return (
    <RadixTooltip.Provider>
      <RadixTooltip.Root open={open} defaultOpen={defaultOpen} onOpenChange={onOpenChange} delayDuration={200}>
        <RadixTooltip.Trigger asChild>{children}</RadixTooltip.Trigger>
        <RadixTooltip.Portal>
          <RadixTooltip.Content
            side={side}
            sideOffset={5}
            className={twMerge(tooltipContent({ intent, size, className }))}
          >
            {explainer}
            {withArrow ? <RadixTooltip.Arrow className={twMerge(tooltipArrow({ intent, size, className }))} /> : null}
          </RadixTooltip.Content>
        </RadixTooltip.Portal>
      </RadixTooltip.Root>
    </RadixTooltip.Provider>
  )
}

===== END components/Tooltip/Tooltip.tsx =====


===== BEGIN components/user-components/index.tsx =====
'use client'

/**
 * Description: User management components
 * Author: Hieu Chu
 */

import { useEffect, useRef, useState } from 'react'
import { useRouter } from 'next/navigation'
import moment from 'moment'

import { Row, Input, Button } from 'antd'
import { SearchOutlined } from '@ant-design/icons'
import { Comment } from '@ant-design/compatible'

import { ColStyled, CardStyled, StyledTable } from './style'
import api from '../../api'
import Loading from '../Loading'
import NextError from 'next/error'
import { convertNonAccent } from '../shared/utils'

const UserList = () => {
  const router = useRouter()

  const [userList, setUserList] = useState<any[]>([])
  const searchInput = useRef<Input | null>(null)
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<{ statusCode: number; message: string } | null>(null)

  useEffect(() => {
    const fetchUsers = async () => {
      try {
        let users = (await api.get('/user')).data
        users = users
          .filter((x: any) => !x.role)
          .map((x: any) => ({
            ...x,
            key: x.userId,
            totalLikes: +x.totalLikes,
            totalComments: +x.totalComments,
            totalVisits: +x.totalVisits,
          }))

        users.sort(
          (a: any, b: any) => new Date(b.joinDate).getTime() - new Date(a.joinDate).getTime(),
        )

        setUserList(users)
      } catch (e: any) {
        const statusCode = e?.response?.data?.statusCode ?? 500
        const message = e?.response?.data?.message ?? 'Failed to load users'
        setError({ statusCode, message })
      } finally {
        setLoading(false)
      }
    }
    fetchUsers()
  }, [])

  const getUserSearchProps = () => ({
    filterDropdown: ({
      setSelectedKeys,
      selectedKeys,
      confirm,
      clearFilters,
    }: {
      setSelectedKeys: (keys: React.Key[]) => void
      selectedKeys: React.Key[]
      confirm: () => void
      clearFilters: () => void
    }) => (
      <div style={{ padding: 8 }}>
        <Input
          ref={searchInput as any}
          placeholder="Search user"
          value={(selectedKeys[0] as string) ?? ''}
          onChange={(e) => setSelectedKeys(e.target.value ? [e.target.value] : [])}
          onPressEnter={() => handleSearch(selectedKeys, confirm)}
          style={{ width: 188, marginBottom: 8, display: 'block' }}
        />
        <Button type="primary" onClick={() => handleSearch(selectedKeys, confirm)} style={{ width: 90, marginRight: 8 }}>
          Search
        </Button>
        <Button onClick={() => handleReset(clearFilters)} style={{ width: 90 }}>
          Reset
        </Button>
      </div>
    ),
    filterIcon: (filtered: boolean) => (
      <SearchOutlined style={{ color: filtered ? '#1890ff' : '#7E7E7E' }} />
    ),
    onFilter: (value: string, record: any) => {
      const { email, name, nickname, userId } = record
      let author = name
      if (userId.includes('auth0')) author = nickname

      return (
        convertNonAccent(author.toLowerCase()).includes(value.toLowerCase()) ||
        convertNonAccent(email.toLowerCase()).includes(value.toLowerCase())
      )
    },
    // AntD v5: "open" naming
    onFilterDropdownOpenChange: (open: boolean) => {
      if (open) {
        setTimeout(() => searchInput.current?.select?.(), 0)
      }
    },
  })

  const handleSearch = (_selectedKeys: React.Key[], confirm: () => void) => {
    confirm()
  }

  const handleReset = (clearFilters: () => void) => {
    clearFilters()
  }

  const columns: any[] = [
    {
      title: 'User',
      key: 'user',
      render: (_: any, record: any) => {
        const { email, name, nickname, picture, userId } = record
        let author = name
        if (userId.includes('auth0')) author = nickname

        return (
          <Comment
            author={
              <span style={{ fontSize: 14, fontWeight: 500, color: 'rgba(0, 0, 0, 0.65)' }}>
                {author}
              </span>
            }
            avatar={
              <img
                src={picture}
                style={{ width: 42, height: 42, borderRadius: '50%', objectFit: 'cover' }}
                alt={author}
              />
            }
            content={<div style={{ fontSize: 14 }}>{email}</div>}
          />
        )
      },
      width: '30%',
      ...getUserSearchProps(),
    },
    {
      title: 'Connection type',
      key: 'connection',
      render: (_: any, record: any) => {
        let connection = ''
        if (record.userId.includes('google')) connection = 'Google'
        else if (record.userId.includes('facebook')) connection = 'Facebook'
        else connection = 'Email'
        return <span>{connection}</span>
      },
      filters: [
        { text: 'Email', value: 'auth0' },
        { text: 'Google', value: 'google' },
        { text: 'Facebook', value: 'facebook' },
      ],
      onFilter: (value: string, record: any) => record.userId.includes(value),
      width: '15%',
    },
    {
      title: 'Join date',
      key: 'joinDate',
      render: (_: any, record: any) => <span>{moment(record.joinDate).format('D MMMM YYYY')}</span>,
      sorter: (a: any, b: any) => new Date(a.joinDate).getTime() - new Date(b.joinDate).getTime(),
      sortDirections: ['ascend', 'descend'],
      width: '15%',
    },
    {
      title: 'Likes',
      dataIndex: 'totalLikes',
      sorter: (a: any, b: any) => a.totalLikes - b.totalLikes,
      sortDirections: ['descend', 'ascend'],
      width: '13.33%',
    },
    {
      title: 'Comments',
      dataIndex: 'totalComments',
      sorter: (a: any, b: any) => a.totalComments - b.totalComments,
      sortDirections: ['descend', 'ascend'],
      width: '13.33%',
    },
    {
      title: 'Visits',
      dataIndex: 'totalVisits',
      sorter: (a: any, b: any) => a.totalVisits - b.totalVisits,
      sortDirections: ['descend', 'ascend'],
      width: '13.33%',
    },
  ]

  if (loading) return <Loading />
  if (error) return <NextError statusCode={error.statusCode} title={error.message} />

  return (
    <Row gutter={16}>
      <ColStyled xs={24}>
        <CardStyled title="User Management">
          <StyledTable
            dataSource={userList}
            columns={columns}
            pagination={{ pageSize: 25, hideOnSinglePage: true }}
            className="user-table"
            onRow={(record: any) => ({
              onClick: () => router.push(`/users/id/${record.key}`),
            })}
            style={{ maxWidth: 1100 }}
          />
        </CardStyled>
      </ColStyled>
    </Row>
  )
}

export default UserList

===== END components/user-components/index.tsx =====


===== BEGIN components/user-components/style.tsx =====
/**
 * Description: Stylesheet for user components
 * Author: Hieu Chu
 */

import styled from 'styled-components'
import { Card, Col, Icon, Form, Typography, Empty, Table } from 'antd'

const { Text } = Typography

export const CardStyled = props => (
  <Card bodyStyle={{ padding: '20px 24px 20px' }} bordered={false} {...props} />
)

export const ColStyled = styled(Col)`
  padding-bottom: 12px;
`

export const DescriptionIcon = styled(Icon)`
  font-size: 20px;
`

export const ShadowCard = styled(CardStyled)`
  box-shadow: rgba(0, 0, 0, 0.06) 0px 9px 24px;
  border-width: 1px;
  border-style: solid;
  border-color: rgb(242, 242, 242);
  border-radius: 3px;
  transition: all 150ms ease-in-out 0s;

  &:hover {
    box-shadow: rgba(0, 0, 0, 0.1) 0px 9px 24px;
    cursor: pointer;
    transition: all 150ms ease-in-out 0s;
  }
`

export const CustomFormItem = styled(Form.Item)`
  margin-bottom: 8px;

  &.ant-form-item-with-help {
    margin-bottom: 5px;
  }
`

export const FormCol = styled(Col)`
  padding-left: 0px !important;
  padding-right: 0px !important;
`

export const Subtitle = styled(Text)`
  display: block;
  margin-bottom: 12px;
`

export const EmptyImage = styled(Empty)`
  height: 230px;
  margin: 0;
  border-bottom: 0.3px solid rgba(0, 0, 0, 0.25);

  & .ant-empty-image {
    margin-top: 220px;
  }
`

export const StyledTable = styled(Table)`
  .ant-table table {
    border-left: 1px solid #e8e8e8;
    border-top: 1px solid #e8e8e8;
    border-right: 1px solid #e8e8e8;
  }
`

===== END components/user-components/style.tsx =====


===== BEGIN components/user-components/UserComments.tsx =====
/**
 * Description: User comments list component
 * Author: Hieu Chu
 */

import moment from 'moment'
import {
  Tooltip,
  List,
  Comment,
  Card,
  Dropdown,
  Icon,
  message,
  Menu,
  Modal,
  Empty
} from 'antd'

const { confirm } = Modal

import Link from 'next/link'
import api from '../../api'

const UserComments = ({ comments, deleteComment }) => {
  const handleDelete = e => {
    console.log(e.key)
    confirm({
      title: 'Delete this comment permanently?',
      icon: <Icon type="exclamation-circle" style={{ color: '#ff4d4f' }} />,
      style: { top: 110 },
      maskClosable: true,
      okText: 'Confirm',
      okButtonProps: {
        style: {
          background: '#ff4d4f',
          borderColor: '#ff4d4f'
        }
      },
      onOk: async () => {
        try {
          const _result = await api.delete(`/comment/${e.key}`)
          message.success('Deleted comment successfully!', 2)
          deleteComment(e.key)
        } catch (error) {
          message.error(error.response.data.message)
        }
      }
    })
  }

  const getMenu = commentId => (
    <Menu onClick={handleDelete}>
      <Menu.Item key={commentId}>Delete comment</Menu.Item>
    </Menu>
  )

  comments.sort(
    (a, b) =>
      new Date(b.createdTime).getTime() - new Date(a.createdTime).getTime()
  )
  const formattedComments = comments.map(x => ({
    author: (
      <span
        style={{
          fontSize: 14,
          fontWeight: 500,
          color: 'rgba(0, 0, 0, 0.65)'
        }}
      >
        {x.user.userId.includes('auth0') ? x.user.nickname : x.user.name}
      </span>
    ),
    avatar: (
      <img
        src={x.user.picture}
        style={{
          width: 42,
          height: 42,
          borderRadius: '50%',
          objectFit: 'cover'
        }}
      />
    ),
    content: (
      <div
        style={{
          fontSize: 14
        }}
      >
        {x.content
          .trim()
          .split('\n')
          .map((line, idx) => (
            <div key={idx}>{line}</div>
          ))}
      </div>
    ),
    datetime: (
      <div
        style={{
          display: 'flex'
        }}
      >
        <div>
          <Tooltip
            title={moment(x.createdTime).format('D MMMM YYYY, h:mm:ss a')}
          >
            <span
              style={{
                fontSize: 14,
                color: 'rgba(0, 0, 0, 0.35)'
              }}
            >
              {moment(x.createdTime).fromNow()} in{' '}
            </span>
          </Tooltip>
          <Link href={`/sculptures/id/${x.sculpture.accessionId}`}>
            <a
              style={{
                fontSize: 14
              }}
            >
              {x.sculpture.name}
            </a>
          </Link>
        </div>

        <div
          style={{
            fontSize: 14,
            color: 'rgba(0, 0, 0, 0.45)',
            marginLeft: 'auto'
          }}
        >
          <Dropdown overlay={getMenu(x.commentId)} trigger={['click']}>
            <Icon type="more" />
          </Dropdown>
        </div>
      </div>
    )
  }))

  return (
    <Card
      title="Comments"
      bodyStyle={{ padding: '20px 24px 0px' }}
      bordered={false}
    >
      <List
        itemLayout="horizontal"
        dataSource={formattedComments}
        className="comment-list"
        locale={{
          emptyText: (
            <Empty
              image={Empty.PRESENTED_IMAGE_SIMPLE}
              description="No Comments"
            />
          )
        }}
        renderItem={item => (
          <li>
            <Comment
              author={item.author}
              avatar={item.avatar}
              content={item.content}
              datetime={item.datetime}
              className="comment"
            />
          </li>
        )}
        pagination={{ pageSize: 15, hideOnSinglePage: true }}
      />
    </Card>
  )
}

export default UserComments

===== END components/user-components/UserComments.tsx =====


===== BEGIN components/user-components/UserLikes.tsx =====
/**
 * Description: User likes list component
 * Author: Hieu Chu
 */

import moment from 'moment'
import { Tooltip, List, Comment, Card, Empty } from 'antd'
import Link from 'next/link'

const UserLikes = ({ likes }) => {
  likes.sort(
    (a, b) => new Date(b.likedTime).getTime() - new Date(a.likedTime).getTime()
  )

  likes.forEach(x => {
    x.sculpture.images.sort(
      (a, b) => new Date(a.created).getTime() - new Date(b.created).getTime()
    )
  })

  const formattedComments = likes.map(x => ({
    author: (
      <span>
        <Link href={`/sculptures/id/${x.sculptureId}`}>
          <a
            style={{
              fontSize: 14,
              fontWeight: 500,
              color: 'rgba(0, 0, 0, 0.65)'
            }}
          >
            {x.sculpture.name}
          </a>
        </Link>
      </span>
    ),
    avatar: (
      <div>
        <img
          src={
            x.sculpture.images.length
              ? x.sculpture.images[0].url
              : '../../static/no-image.png'
          }
          style={{
            width: 42,
            height: 42,
            objectFit: 'cover',
            borderRadius: 4
          }}
        />
      </div>
    ),
    content: (
      <div
        style={{
          fontSize: 14
        }}
      >
        <Tooltip title={moment(x.likedTime).format('D MMMM YYYY, h:mm:ss a')}>
          <span
            style={{
              fontSize: 14,
              color: 'rgba(0, 0, 0, 0.35)'
            }}
          >
            {moment(x.likedTime).fromNow()}
          </span>
        </Tooltip>
      </div>
    )
  }))

  return (
    <Card
      title="Likes"
      bodyStyle={{ padding: '20px 24px 0px' }}
      bordered={false}
      style={{ marginTop: 12 }}
    >
      <List
        itemLayout="horizontal"
        dataSource={formattedComments}
        className="comment-list"
        locale={{
          emptyText: (
            <Empty
              image={Empty.PRESENTED_IMAGE_SIMPLE}
              description="No Likes"
            />
          )
        }}
        renderItem={item => (
          <li>
            <Comment
              author={item.author}
              avatar={item.avatar}
              content={item.content}
              className="comment"
            />
          </li>
        )}
        pagination={{ pageSize: 15, hideOnSinglePage: true }}
      />
    </Card>
  )
}

export default UserLikes

===== END components/user-components/UserLikes.tsx =====


===== BEGIN components/user-components/UserProfile.tsx =====
'use client'

/**
 * Description: User profile component
 * Author: Hieu Chu
 */

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { Row, Descriptions } from 'antd'
import { ColStyled, CardStyled } from './style'
import api from '../../api'
import Loading from '../Loading'
import Error from 'next/error'
import Head from 'next/head'
import moment from 'moment'
import { SculptureCardDescription } from '../sculpture-maker-components/SculptureGrid'
import UserComments from './UserComments'
import UserVisit from './UserVisit'
import UserLikes from './UserLikes'

const UserProfile = () => {
  const router = useRouter()
  const id = router.query.id

  const [user, setUser] = useState(null)
  const [comments, setComments] = useState([])
  const [visits, setVisits] = useState([])
  const [likes, setLikes] = useState([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)

  const deleteComment = commentId => {
    setComments(c => c.filter(x => x.commentId !== commentId))
  }

  useEffect(() => {
    const fetchData = async () => {
      try {
        const userPromise = api.get(`/user/${id}`)
        const commentPromise = api.get(`/comment/user-id/${id}`)
        const visitPromise = api.get(`/visit/user-id/${id}`)
        const likePromise = api.get(`/like/user-id/${id}`)

        const [rawUser, rawComments, rawVisits, rawLikes] = await Promise.all([
          userPromise,
          commentPromise,
          visitPromise,
          likePromise
        ])
        setUser(rawUser.data)
        setComments(rawComments.data)
        setVisits(rawVisits.data)
        setLikes(rawLikes.data)

        console.log('comments', rawComments.data)
        console.log('visits', rawVisits.data)
        console.log('likes', rawLikes.data)
      } catch (e) {
        const { statusCode, message } = e.response.data
        setError({
          statusCode,
          message
        })
      }
      setLoading(false)
    }

    fetchData()
  }, [id])

  if (loading) return <Loading />
  if (error)
    return <Error statusCode={error.statusCode} title={error.message} />

  const { email, name, nickname, picture, userId, joinDate } = user

  let displayName = name
  if (userId.includes('auth0')) {
    displayName = nickname
  }

  let connection = 'Email'
  if (userId.includes('google')) {
    connection = 'Google'
  } else if (userId.includes('facebook')) {
    connection = 'Facebook'
  }

  return (
    <>
      <Head>
        <title>{displayName} - UOW Sculptures</title>
      </Head>

      <Row gutter={16}>
        <ColStyled xs={24} lg={12}>
          <CardStyled title="User Profile">
            <div
              style={{
                marginBottom: 12,
                display: 'flex',
                alignItems: 'center'
              }}
            >
              <div style={{ marginRight: 16 }}>
                <img
                  src={picture}
                  style={{
                    width: 72,
                    height: 72,
                    borderRadius: '50%',
                    objectFit: 'cover'
                  }}
                />
              </div>
              <div>
                <div
                  style={{
                    fontSize: 20,
                    fontWeight: 500,
                    color: 'black'
                  }}
                >
                  {displayName}
                </div>
                <SculptureCardDescription
                  totalLikes={likes.length}
                  totalComments={comments.length}
                  totalVisits={visits.length}
                />
              </div>
            </div>

            <Descriptions
              layout="vertical"
              colon={false}
              style={{ maxWidth: 600 }}
            >
              <Descriptions.Item label="Name">{displayName}</Descriptions.Item>
              <Descriptions.Item label="Email" span={2}>
                {email}
              </Descriptions.Item>
              <Descriptions.Item label="Connection type">
                {connection}
              </Descriptions.Item>
              <Descriptions.Item label="Join date">
                {moment(joinDate).format('D MMMM YYYY')}
              </Descriptions.Item>
            </Descriptions>
          </CardStyled>

          <UserVisit visits={visits} />
        </ColStyled>

        <ColStyled xs={24} lg={12}>
          <UserComments comments={comments} deleteComment={deleteComment} />
          <UserLikes likes={likes} />
        </ColStyled>
      </Row>
    </>
  )
}

export default UserProfile

===== END components/user-components/UserProfile.tsx =====


===== BEGIN components/user-components/UserVisit.tsx =====
/**
 * Description: User visit list component
 * Author: Hieu Chu
 */

import moment from 'moment'
import { Tooltip, List, Card, Empty } from 'antd'
import { Comment } from '@ant-design/compatible'
import Link from 'next/link'

const UserVisit = ({ visits }) => {
  visits.sort(
    (a, b) => new Date(b.visitTime).getTime() - new Date(a.visitTime).getTime()
  )
  visits.forEach(x => {
    x.sculpture.images.sort(
      (a, b) => new Date(a.created).getTime() - new Date(b.created).getTime()
    )
  })

  const formattedComments = visits.map(x => ({
    author: (
      <span>
        <Link href={`/sculptures/id/${x.sculptureId}`}>
          <a
            style={{
              fontSize: 14,
              fontWeight: 500,
              color: 'rgba(0, 0, 0, 0.65)'
            }}
          >
            {x.sculpture.name}
          </a>
        </Link>
      </span>
    ),
    avatar: (
      <div>
        <img
          src={
            x.sculpture.images.length
              ? x.sculpture.images[0].url
              : '../../static/no-image.png'
          }
          style={{
            width: 42,
            height: 42,
            objectFit: 'cover',
            borderRadius: 4
          }}
        />
      </div>
    ),
    content: (
      <div style={{ fontSize: 14 }}>
        <Tooltip title={moment(x.visitTime).format('D MMMM YYYY, h:mm:ss a')}>
          <span style={{ fontSize: 14, color: 'rgba(0, 0, 0, 0.35)' }}>
            {moment(x.visitTime).fromNow()}
          </span>
        </Tooltip>
      </div>
    )
  }))

  return (
    <Card
      title="Visits"
      bodyStyle={{ padding: '20px 24px 0px' }}
      bordered={false}
      style={{ marginTop: 12 }}
    >
      <List
        itemLayout="horizontal"
        dataSource={formattedComments}
        className="comment-list"
        locale={{
          emptyText: (
            <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description="No Visits" />
          )
        }}
        renderItem={item => (
          <li>
            <Comment author={item.author} avatar={item.avatar} content={item.content} className="comment" />
          </li>
        )}
        pagination={{ pageSize: 15, hideOnSinglePage: true }}
      />
    </Card>
  )
}

export default UserVisit

===== END components/user-components/UserVisit.tsx =====


===== BEGIN src/components/CommonWidget/page.tsx =====
// pages/pageTemplate/components/CommonWidget.tsx
import React from 'react';
import styles from './CommonWidget.module.css';

interface CommonWidgetProps {
  title: string;
  description: string;
}

const CommonWidget: React.FC<CommonWidgetProps> = ({ title, description }) => {
  return (
    <div className={styles.widget}>
      <h2 className={styles.widgetTitle}>{title}</h2>
      <p className={styles.widgetDescription}>{description}</p>
    </div>
  );
};

export default CommonWidget;

===== END src/components/CommonWidget/page.tsx =====


===== BEGIN src/components/ThemeSwitcher.tsx =====
import React from 'react';
import { Button } from 'antd';
import { useTheme } from '@/context/ThemeContext';

const ThemeSwitcher: React.FC = () => {
  const { token, cycleTheme } = useTheme();   // token contient label + icon

  return (
    <Button onClick={cycleTheme}>
      {token.icon ? `${token.icon} ` : ''}{token.label ?? 'Theme'}
    </Button>
  );
};

export default ThemeSwitcher;

===== END src/components/ThemeSwitcher.tsx =====

